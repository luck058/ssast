mkdir: cannot create directory ‘exp’: File exists
esc-50 already downloaded and processed.
pretrained model already downloaded.
now process fold1
I am process 4113046, running on scotia07.inf.ed.ac.uk: starting (Thu Nov  6 11:50:59 2025)
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process esc50
use dataset mean -6.627 and std 5.358 to normalize the input.
now use noise augmentation
number of classes is 50
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process esc50
use dataset mean -6.627 and std 5.358 to normalize the input.
number of classes is 50
Now train with esc50 with 1600 training samples, evaluate with 400 samples
now load a SSL pretrained models from ./SSAST-Tiny-Patch-400.pth
pretraining patch split stride: frequency=16, time=16
pretraining patch shape: frequency=16, time=16
pretraining patch array dimension: frequency=8, time=64
pretraining number of patches=512
fine-tuning patch split stride: frequncey=10, time=10
fine-tuning number of patches=600

Creating experiment directory: ./exp/test01-esc50-f10-16-t10-16-b48-lr1e-4-ft_avgtok-tiny--SSAST-Tiny-Patch-400-1x-noiseTrue/fold1
Now starting fine-tuning for 50 epochs
running on cuda
Total parameter number is : 5.900 million
Total trainable parameter number is : 5.900 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.010 million
Total base parameter number is : 5.890 million
now training with esc50, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x779bd7c52450>
The learning rate scheduler starts at 6 epoch with decay rate of 0.850 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2025-11-06 11:51:02.405589
current #epochs=1, #steps=0
start validation
acc: 0.097500
AUC: 0.830459
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 1.351962
train_loss: 3.744084
valid_loss: 3.780321
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0001
Epoch-1 lr: 0.0001
epoch 1 training time: 34.078
---------------
2025-11-06 11:51:36.484618
current #epochs=2, #steps=33
start validation
acc: 0.285000
AUC: 0.919145
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 1.978974
train_loss: 3.215997
valid_loss: 3.652034
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0001
Epoch-2 lr: 0.0001
epoch 2 training time: 24.247
---------------
2025-11-06 11:52:00.731739
current #epochs=3, #steps=66
start validation
acc: 0.460000
AUC: 0.951486
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.346796
train_loss: 2.679042
valid_loss: 3.572953
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0001
Epoch-3 lr: 0.0001
epoch 3 training time: 23.245
---------------
2025-11-06 11:52:23.976511
current #epochs=4, #steps=99
Epoch: [4][1/33]	Per Sample Total Time 0.12945	Per Sample Data Time 0.12606	Per Sample DNN Time 0.00338	Train Loss 2.4553	
start validation
acc: 0.542500
AUC: 0.966709
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.594357
train_loss: 2.180399
valid_loss: 3.523629
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0001
Epoch-4 lr: 0.0001
epoch 4 training time: 23.534
---------------
2025-11-06 11:52:47.510135
current #epochs=5, #steps=132
start validation
acc: 0.657500
AUC: 0.978348
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.857800
train_loss: 1.750740
valid_loss: 3.490660
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0001
Epoch-5 lr: 0.0001
epoch 5 training time: 23.290
---------------
2025-11-06 11:53:10.800268
current #epochs=6, #steps=165
start validation
acc: 0.685000
AUC: 0.982621
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.985646
train_loss: 1.430387
valid_loss: 3.472834
validation finished
normal learning rate scheduler step
Epoch-6 lr: 8.5e-05
Epoch-6 lr: 8.5e-05
epoch 6 training time: 23.017
---------------
2025-11-06 11:53:33.817483
current #epochs=7, #steps=198
Epoch: [7][2/33]	Per Sample Total Time 0.09134	Per Sample Data Time 0.08821	Per Sample DNN Time 0.00314	Train Loss 1.2423	
start validation
acc: 0.720000
AUC: 0.985306
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.080505
train_loss: 1.151318
valid_loss: 3.455430
validation finished
normal learning rate scheduler step
Epoch-7 lr: 7.225000000000001e-05
Epoch-7 lr: 7.225000000000001e-05
epoch 7 training time: 23.339
---------------
2025-11-06 11:53:57.156993
current #epochs=8, #steps=231
start validation
acc: 0.765000
AUC: 0.986014
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.107988
train_loss: 0.974901
valid_loss: 3.454761
validation finished
normal learning rate scheduler step
Epoch-8 lr: 6.141250000000001e-05
Epoch-8 lr: 6.141250000000001e-05
epoch 8 training time: 23.133
---------------
2025-11-06 11:54:20.290357
current #epochs=9, #steps=264
start validation
acc: 0.770000
AUC: 0.987787
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.182491
train_loss: 0.826639
valid_loss: 3.448803
validation finished
normal learning rate scheduler step
Epoch-9 lr: 5.2200625000000005e-05
Epoch-9 lr: 5.2200625000000005e-05
epoch 9 training time: 23.978
---------------
2025-11-06 11:54:44.268058
current #epochs=10, #steps=297
Epoch: [10][3/33]	Per Sample Total Time 0.07296	Per Sample Data Time 0.06976	Per Sample DNN Time 0.00320	Train Loss 0.7281	
start validation
acc: 0.765000
AUC: 0.987608
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.174578
train_loss: 0.715404
valid_loss: 3.444897
validation finished
normal learning rate scheduler step
Epoch-10 lr: 4.437053125e-05
Epoch-10 lr: 4.437053125e-05
epoch 10 training time: 24.153
---------------
2025-11-06 11:55:08.421029
current #epochs=11, #steps=330
start validation
acc: 0.787500
AUC: 0.989318
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.254777
train_loss: 0.629329
valid_loss: 3.442258
validation finished
normal learning rate scheduler step
Epoch-11 lr: 3.77149515625e-05
Epoch-11 lr: 3.77149515625e-05
epoch 11 training time: 23.846
---------------
2025-11-06 11:55:32.266646
current #epochs=12, #steps=363
start validation
acc: 0.802500
AUC: 0.989790
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.278887
train_loss: 0.581572
valid_loss: 3.439992
validation finished
normal learning rate scheduler step
Epoch-12 lr: 3.2057708828124995e-05
Epoch-12 lr: 3.2057708828124995e-05
epoch 12 training time: 24.089
---------------
2025-11-06 11:55:56.355364
current #epochs=13, #steps=396
Epoch: [13][4/33]	Per Sample Total Time 0.05837	Per Sample Data Time 0.05516	Per Sample DNN Time 0.00321	Train Loss 0.5021	
start validation
acc: 0.822500
AUC: 0.989388
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.258302
train_loss: 0.535504
valid_loss: 3.439724
validation finished
normal learning rate scheduler step
Epoch-13 lr: 2.7249052503906245e-05
Epoch-13 lr: 2.7249052503906245e-05
epoch 13 training time: 23.502
---------------
2025-11-06 11:56:19.857525
current #epochs=14, #steps=429
start validation
acc: 0.822500
AUC: 0.990874
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.338187
train_loss: 0.491546
valid_loss: 3.437231
validation finished
normal learning rate scheduler step
Epoch-14 lr: 2.3161694628320308e-05
Epoch-14 lr: 2.3161694628320308e-05
epoch 14 training time: 21.799
---------------
2025-11-06 11:56:41.655962
current #epochs=15, #steps=462
start validation
acc: 0.827500
AUC: 0.989802
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.279552
train_loss: 0.447334
valid_loss: 3.436503
validation finished
normal learning rate scheduler step
Epoch-15 lr: 1.9687440434072263e-05
Epoch-15 lr: 1.9687440434072263e-05
epoch 15 training time: 22.580
---------------
2025-11-06 11:57:04.235603
current #epochs=16, #steps=495
Epoch: [16][5/33]	Per Sample Total Time 0.04940	Per Sample Data Time 0.04619	Per Sample DNN Time 0.00320	Train Loss 0.4336	
start validation
acc: 0.807500
AUC: 0.990466
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.315174
train_loss: 0.430392
valid_loss: 3.437839
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.673432436896142e-05
Epoch-16 lr: 1.673432436896142e-05
epoch 16 training time: 23.637
---------------
2025-11-06 11:57:27.872543
current #epochs=17, #steps=528
start validation
acc: 0.825000
AUC: 0.991071
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.349660
train_loss: 0.423119
valid_loss: 3.434581
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.4224175713617208e-05
Epoch-17 lr: 1.4224175713617208e-05
epoch 17 training time: 23.426
---------------
2025-11-06 11:57:51.298508
current #epochs=18, #steps=561
start validation
acc: 0.827500
AUC: 0.990695
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.328010
train_loss: 0.392474
valid_loss: 3.435811
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.2090549356574626e-05
Epoch-18 lr: 1.2090549356574626e-05
epoch 18 training time: 22.788
---------------
2025-11-06 11:58:14.086566
current #epochs=19, #steps=594
Epoch: [19][6/33]	Per Sample Total Time 0.03980	Per Sample Data Time 0.03660	Per Sample DNN Time 0.00320	Train Loss 0.3822	
start validation
acc: 0.830000
AUC: 0.990293
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.305722
train_loss: 0.374585
valid_loss: 3.434895
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.0276966953088432e-05
Epoch-19 lr: 1.0276966953088432e-05
epoch 19 training time: 22.552
---------------
2025-11-06 11:58:36.638875
current #epochs=20, #steps=627
start validation
acc: 0.825000
AUC: 0.990912
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.340390
train_loss: 0.375359
valid_loss: 3.434901
validation finished
normal learning rate scheduler step
Epoch-20 lr: 8.735421910125167e-06
Epoch-20 lr: 8.735421910125167e-06
epoch 20 training time: 22.201
---------------
2025-11-06 11:58:58.839936
current #epochs=21, #steps=660
start validation
acc: 0.832500
AUC: 0.991116
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.352281
train_loss: 0.358181
valid_loss: 3.433656
validation finished
normal learning rate scheduler step
Epoch-21 lr: 7.425108623606392e-06
Epoch-21 lr: 7.425108623606392e-06
epoch 21 training time: 23.326
---------------
2025-11-06 11:59:22.165897
current #epochs=22, #steps=693
Epoch: [22][7/33]	Per Sample Total Time 0.03703	Per Sample Data Time 0.03382	Per Sample DNN Time 0.00321	Train Loss 0.3486	
start validation
acc: 0.835000
AUC: 0.990421
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.312709
train_loss: 0.342107
valid_loss: 3.434190
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.3113423300654325e-06
Epoch-22 lr: 6.3113423300654325e-06
epoch 22 training time: 23.243
---------------
2025-11-06 11:59:45.409395
current #epochs=23, #steps=726
start validation
acc: 0.830000
AUC: 0.990606
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.322986
train_loss: 0.341282
valid_loss: 3.434681
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.3646409805556175e-06
Epoch-23 lr: 5.3646409805556175e-06
epoch 23 training time: 23.128
---------------
2025-11-06 12:00:08.537498
current #epochs=24, #steps=759
start validation
acc: 0.830000
AUC: 0.990899
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.339655
train_loss: 0.344088
valid_loss: 3.433830
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.559944833472275e-06
Epoch-24 lr: 4.559944833472275e-06
epoch 24 training time: 21.446
---------------
2025-11-06 12:00:29.983682
current #epochs=25, #steps=792
Epoch: [25][8/33]	Per Sample Total Time 0.01537	Per Sample Data Time 0.01212	Per Sample DNN Time 0.00325	Train Loss 0.3568	
start validation
acc: 0.827500
AUC: 0.990823
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.335262
train_loss: 0.341227
valid_loss: 3.434206
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.875953108451433e-06
Epoch-25 lr: 3.875953108451433e-06
epoch 25 training time: 13.996
---------------
2025-11-06 12:00:43.979495
current #epochs=26, #steps=825
start validation
acc: 0.827500
AUC: 0.990772
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.332350
train_loss: 0.327827
valid_loss: 3.433826
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.2945601421837183e-06
Epoch-26 lr: 3.2945601421837183e-06
epoch 26 training time: 14.745
---------------
2025-11-06 12:00:58.724801
current #epochs=27, #steps=858
start validation
acc: 0.827500
AUC: 0.990765
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.331988
train_loss: 0.327578
valid_loss: 3.433959
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.8003761208561607e-06
Epoch-27 lr: 2.8003761208561607e-06
epoch 27 training time: 14.901
---------------
2025-11-06 12:01:13.625590
current #epochs=28, #steps=891
Epoch: [28][9/33]	Per Sample Total Time 0.01463	Per Sample Data Time 0.01130	Per Sample DNN Time 0.00333	Train Loss 0.3092	
start validation
acc: 0.835000
AUC: 0.990893
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.339288
train_loss: 0.311663
valid_loss: 3.433717
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.3803197027277364e-06
Epoch-28 lr: 2.3803197027277364e-06
epoch 28 training time: 14.152
---------------
2025-11-06 12:01:27.777385
current #epochs=29, #steps=924
start validation
acc: 0.830000
AUC: 0.990925
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.341127
train_loss: 0.327541
valid_loss: 3.433704
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.0232717473185757e-06
Epoch-29 lr: 2.0232717473185757e-06
epoch 29 training time: 13.861
---------------
2025-11-06 12:01:41.637818
current #epochs=30, #steps=957
start validation
acc: 0.835000
AUC: 0.990944
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.342233
train_loss: 0.320039
valid_loss: 3.433456
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.7197809852207893e-06
Epoch-30 lr: 1.7197809852207893e-06
epoch 30 training time: 13.514
---------------
2025-11-06 12:01:55.151467
current #epochs=31, #steps=990
Epoch: [31][10/33]	Per Sample Total Time 0.01325	Per Sample Data Time 0.00995	Per Sample DNN Time 0.00330	Train Loss 0.2960	
start validation
acc: 0.837500
AUC: 0.991033
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.347422
train_loss: 0.309215
valid_loss: 3.433419
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.4618138374376709e-06
Epoch-31 lr: 1.4618138374376709e-06
epoch 31 training time: 13.944
---------------
2025-11-06 12:02:09.096027
current #epochs=32, #steps=1023
start validation
acc: 0.837500
AUC: 0.990998
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.345378
train_loss: 0.313530
valid_loss: 3.433574
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.2425417618220202e-06
Epoch-32 lr: 1.2425417618220202e-06
epoch 32 training time: 14.010
---------------
2025-11-06 12:02:23.105500
current #epochs=33, #steps=1056
start validation
acc: 0.832500
AUC: 0.991071
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.349660
train_loss: 0.313421
valid_loss: 3.433307
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.0561604975487172e-06
Epoch-33 lr: 1.0561604975487172e-06
epoch 33 training time: 13.754
---------------
2025-11-06 12:02:36.859921
current #epochs=34, #steps=1089
Epoch: [34][11/33]	Per Sample Total Time 0.01241	Per Sample Data Time 0.00913	Per Sample DNN Time 0.00328	Train Loss 0.3029	
start validation
acc: 0.832500
AUC: 0.991135
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.353408
train_loss: 0.311117
valid_loss: 3.433276
validation finished
normal learning rate scheduler step
Epoch-34 lr: 8.977364229164096e-07
Epoch-34 lr: 8.977364229164096e-07
epoch 34 training time: 13.883
---------------
2025-11-06 12:02:50.742641
current #epochs=35, #steps=1122
start validation
acc: 0.835000
AUC: 0.991078
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.350033
train_loss: 0.317630
valid_loss: 3.433367
validation finished
normal learning rate scheduler step
Epoch-35 lr: 7.630759594789481e-07
Epoch-35 lr: 7.630759594789481e-07
epoch 35 training time: 13.872
---------------
2025-11-06 12:03:04.614794
current #epochs=36, #steps=1155
start validation
acc: 0.835000
AUC: 0.991001
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.345563
train_loss: 0.315542
valid_loss: 3.433509
validation finished
normal learning rate scheduler step
Epoch-36 lr: 6.486145655571059e-07
Epoch-36 lr: 6.486145655571059e-07
epoch 36 training time: 13.674
---------------
2025-11-06 12:03:18.289045
current #epochs=37, #steps=1188
Epoch: [37][12/33]	Per Sample Total Time 0.01112	Per Sample Data Time 0.00781	Per Sample DNN Time 0.00331	Train Loss 0.3112	
start validation
acc: 0.835000
AUC: 0.991008
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.345935
train_loss: 0.308206
valid_loss: 3.433413
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.5132238072354e-07
Epoch-37 lr: 5.5132238072354e-07
epoch 37 training time: 13.823
---------------
2025-11-06 12:03:32.111808
current #epochs=38, #steps=1221
start validation
acc: 0.835000
AUC: 0.990957
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.342971
train_loss: 0.300724
valid_loss: 3.433378
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.68624023615009e-07
Epoch-38 lr: 4.68624023615009e-07
epoch 38 training time: 13.818
---------------
2025-11-06 12:03:45.929902
current #epochs=39, #steps=1254
start validation
acc: 0.835000
AUC: 0.991027
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.347050
train_loss: 0.317128
valid_loss: 3.433224
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.983304200727576e-07
Epoch-39 lr: 3.983304200727576e-07
epoch 39 training time: 13.415
---------------
2025-11-06 12:03:59.344979
current #epochs=40, #steps=1287
Epoch: [40][13/33]	Per Sample Total Time 0.01125	Per Sample Data Time 0.00806	Per Sample DNN Time 0.00319	Train Loss 0.3037	
start validation
acc: 0.835000
AUC: 0.991040
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.347794
train_loss: 0.308758
valid_loss: 3.433155
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.38580857061844e-07
Epoch-40 lr: 3.38580857061844e-07
epoch 40 training time: 14.027
---------------
2025-11-06 12:04:13.372308
current #epochs=41, #steps=1320
start validation
acc: 0.835000
AUC: 0.991040
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.347794
train_loss: 0.300348
valid_loss: 3.433205
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.877937285025674e-07
Epoch-41 lr: 2.877937285025674e-07
epoch 41 training time: 13.895
---------------
2025-11-06 12:04:27.267744
current #epochs=42, #steps=1353
start validation
acc: 0.835000
AUC: 0.991046
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.348167
train_loss: 0.313804
valid_loss: 3.433157
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.4462466922718226e-07
Epoch-42 lr: 2.4462466922718226e-07
epoch 42 training time: 13.743
---------------
2025-11-06 12:04:41.011156
current #epochs=43, #steps=1386
Epoch: [43][14/33]	Per Sample Total Time 0.01044	Per Sample Data Time 0.00706	Per Sample DNN Time 0.00338	Train Loss 0.3142	
start validation
acc: 0.835000
AUC: 0.991033
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.347422
train_loss: 0.306390
valid_loss: 3.433147
validation finished
normal learning rate scheduler step
Epoch-43 lr: 2.079309688431049e-07
Epoch-43 lr: 2.079309688431049e-07
epoch 43 training time: 13.931
---------------
2025-11-06 12:04:54.942499
current #epochs=44, #steps=1419
start validation
acc: 0.835000
AUC: 0.991065
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.349286
train_loss: 0.303531
valid_loss: 3.433141
validation finished
normal learning rate scheduler step
Epoch-44 lr: 1.7674132351663916e-07
Epoch-44 lr: 1.7674132351663916e-07
epoch 44 training time: 13.754
---------------
2025-11-06 12:05:08.696469
current #epochs=45, #steps=1452
start validation
acc: 0.835000
AUC: 0.991040
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.347794
train_loss: 0.310169
valid_loss: 3.433146
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.5023012498914328e-07
Epoch-45 lr: 1.5023012498914328e-07
epoch 45 training time: 13.725
---------------
2025-11-06 12:05:22.421197
current #epochs=46, #steps=1485
Epoch: [46][15/33]	Per Sample Total Time 0.01029	Per Sample Data Time 0.00712	Per Sample DNN Time 0.00317	Train Loss 0.3199	
start validation
acc: 0.835000
AUC: 0.991033
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.347422
train_loss: 0.315420
valid_loss: 3.433142
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.276956062407718e-07
Epoch-46 lr: 1.276956062407718e-07
epoch 46 training time: 14.095
---------------
2025-11-06 12:05:36.515928
current #epochs=47, #steps=1518
start validation
acc: 0.835000
AUC: 0.991059
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.348913
train_loss: 0.317297
valid_loss: 3.433125
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.0854126530465602e-07
Epoch-47 lr: 1.0854126530465602e-07
epoch 47 training time: 13.704
---------------
2025-11-06 12:05:50.219827
current #epochs=48, #steps=1551
start validation
acc: 0.835000
AUC: 0.991052
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.348540
train_loss: 0.312105
valid_loss: 3.433141
validation finished
normal learning rate scheduler step
Epoch-48 lr: 9.226007550895761e-08
Epoch-48 lr: 9.226007550895761e-08
epoch 48 training time: 14.031
---------------
2025-11-06 12:06:04.250951
current #epochs=49, #steps=1584
Epoch: [49][16/33]	Per Sample Total Time 0.01053	Per Sample Data Time 0.00735	Per Sample DNN Time 0.00318	Train Loss 0.3077	
start validation
acc: 0.835000
AUC: 0.991027
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.347050
train_loss: 0.308515
valid_loss: 3.433181
validation finished
normal learning rate scheduler step
Epoch-49 lr: 7.842106418261397e-08
Epoch-49 lr: 7.842106418261397e-08
epoch 49 training time: 14.077
---------------
2025-11-06 12:06:18.327893
current #epochs=50, #steps=1617
start validation
acc: 0.835000
AUC: 0.991020
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.346678
train_loss: 0.301217
valid_loss: 3.433181
validation finished
normal learning rate scheduler step
Epoch-50 lr: 6.665790455522187e-08
Epoch-50 lr: 6.665790455522187e-08
epoch 50 training time: 13.775
now process fold2
I am process 4120699, running on scotia07.inf.ed.ac.uk: starting (Thu Nov  6 12:07:19 2025)
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process esc50
use dataset mean -6.627 and std 5.358 to normalize the input.
now use noise augmentation
number of classes is 50
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process esc50
use dataset mean -6.627 and std 5.358 to normalize the input.
number of classes is 50
Now train with esc50 with 1600 training samples, evaluate with 400 samples
now load a SSL pretrained models from ./SSAST-Tiny-Patch-400.pth
pretraining patch split stride: frequency=16, time=16
pretraining patch shape: frequency=16, time=16
pretraining patch array dimension: frequency=8, time=64
pretraining number of patches=512
fine-tuning patch split stride: frequncey=10, time=10
fine-tuning number of patches=600

Creating experiment directory: ./exp/test01-esc50-f10-16-t10-16-b48-lr1e-4-ft_avgtok-tiny--SSAST-Tiny-Patch-400-1x-noiseTrue/fold2
Now starting fine-tuning for 50 epochs
running on cuda
Total parameter number is : 5.900 million
Total trainable parameter number is : 5.900 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.010 million
Total base parameter number is : 5.890 million
now training with esc50, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7099924c0620>
The learning rate scheduler starts at 6 epoch with decay rate of 0.850 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2025-11-06 12:07:20.361924
current #epochs=1, #steps=0
start validation
acc: 0.217500
AUC: 0.848386
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 1.455986
train_loss: 3.697636
valid_loss: 3.752297
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0001
Epoch-1 lr: 0.0001
epoch 1 training time: 18.063
---------------
2025-11-06 12:07:38.426096
current #epochs=2, #steps=33
start validation
acc: 0.337500
AUC: 0.911760
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 1.911556
train_loss: 3.078727
valid_loss: 3.656394
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0001
Epoch-2 lr: 0.0001
epoch 2 training time: 14.260
---------------
2025-11-06 12:07:52.685950
current #epochs=3, #steps=66
start validation
acc: 0.427500
AUC: 0.941633
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.218375
train_loss: 2.571323
valid_loss: 3.590308
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0001
Epoch-3 lr: 0.0001
epoch 3 training time: 14.017
---------------
2025-11-06 12:08:06.703386
current #epochs=4, #steps=99
Epoch: [4][1/33]	Per Sample Total Time 0.05218	Per Sample Data Time 0.04882	Per Sample DNN Time 0.00336	Train Loss 2.1873	
start validation
acc: 0.510000
AUC: 0.958814
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.456607
train_loss: 2.107474
valid_loss: 3.537140
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0001
Epoch-4 lr: 0.0001
epoch 4 training time: 13.920
---------------
2025-11-06 12:08:20.623791
current #epochs=5, #steps=132
start validation
acc: 0.640000
AUC: 0.970364
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.667438
train_loss: 1.739140
valid_loss: 3.502372
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0001
Epoch-5 lr: 0.0001
epoch 5 training time: 13.885
---------------
2025-11-06 12:08:34.508617
current #epochs=6, #steps=165
start validation
acc: 0.642500
AUC: 0.977640
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.838729
train_loss: 1.419438
valid_loss: 3.481574
validation finished
normal learning rate scheduler step
Epoch-6 lr: 8.5e-05
Epoch-6 lr: 8.5e-05
epoch 6 training time: 14.007
---------------
2025-11-06 12:08:48.515442
current #epochs=7, #steps=198
Epoch: [7][2/33]	Per Sample Total Time 0.03758	Per Sample Data Time 0.03411	Per Sample DNN Time 0.00347	Train Loss 1.2337	
start validation
acc: 0.702500
AUC: 0.980995
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.934132
train_loss: 1.174463
valid_loss: 3.465794
validation finished
normal learning rate scheduler step
Epoch-7 lr: 7.225000000000001e-05
Epoch-7 lr: 7.225000000000001e-05
epoch 7 training time: 13.996
---------------
2025-11-06 12:09:02.511759
current #epochs=8, #steps=231
start validation
acc: 0.720000
AUC: 0.981977
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.964770
train_loss: 0.953485
valid_loss: 3.463303
validation finished
normal learning rate scheduler step
Epoch-8 lr: 6.141250000000001e-05
Epoch-8 lr: 6.141250000000001e-05
epoch 8 training time: 14.058
---------------
2025-11-06 12:09:16.570296
current #epochs=9, #steps=264
start validation
acc: 0.752500
AUC: 0.983335
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.009583
train_loss: 0.809945
valid_loss: 3.458390
validation finished
normal learning rate scheduler step
Epoch-9 lr: 5.2200625000000005e-05
Epoch-9 lr: 5.2200625000000005e-05
epoch 9 training time: 13.789
---------------
2025-11-06 12:09:30.359475
current #epochs=10, #steps=297
Epoch: [10][3/33]	Per Sample Total Time 0.02762	Per Sample Data Time 0.02414	Per Sample DNN Time 0.00348	Train Loss 0.6721	
start validation
acc: 0.730000
AUC: 0.982915
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.995374
train_loss: 0.726752
valid_loss: 3.460283
validation finished
normal learning rate scheduler step
Epoch-10 lr: 4.437053125e-05
Epoch-10 lr: 4.437053125e-05
epoch 10 training time: 13.641
---------------
2025-11-06 12:09:44.000856
current #epochs=11, #steps=330
start validation
acc: 0.755000
AUC: 0.984949
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.067069
train_loss: 0.625703
valid_loss: 3.455192
validation finished
normal learning rate scheduler step
Epoch-11 lr: 3.77149515625e-05
Epoch-11 lr: 3.77149515625e-05
epoch 11 training time: 14.196
---------------
2025-11-06 12:09:58.196511
current #epochs=12, #steps=363
start validation
acc: 0.792500
AUC: 0.987806
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.183345
train_loss: 0.571121
valid_loss: 3.448043
validation finished
normal learning rate scheduler step
Epoch-12 lr: 3.2057708828124995e-05
Epoch-12 lr: 3.2057708828124995e-05
epoch 12 training time: 14.170
---------------
2025-11-06 12:10:12.366667
current #epochs=13, #steps=396
Epoch: [13][4/33]	Per Sample Total Time 0.02479	Per Sample Data Time 0.02120	Per Sample DNN Time 0.00358	Train Loss 0.5501	
start validation
acc: 0.775000
AUC: 0.986212
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.115878
train_loss: 0.517703
valid_loss: 3.450263
validation finished
normal learning rate scheduler step
Epoch-13 lr: 2.7249052503906245e-05
Epoch-13 lr: 2.7249052503906245e-05
epoch 13 training time: 14.063
---------------
2025-11-06 12:10:26.429914
current #epochs=14, #steps=429
start validation
acc: 0.775000
AUC: 0.986097
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.111285
train_loss: 0.470345
valid_loss: 3.450799
validation finished
normal learning rate scheduler step
Epoch-14 lr: 2.3161694628320308e-05
Epoch-14 lr: 2.3161694628320308e-05
epoch 14 training time: 13.950
---------------
2025-11-06 12:10:40.379725
current #epochs=15, #steps=462
start validation
acc: 0.790000
AUC: 0.987041
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.150066
train_loss: 0.457442
valid_loss: 3.446220
validation finished
normal learning rate scheduler step
Epoch-15 lr: 1.9687440434072263e-05
Epoch-15 lr: 1.9687440434072263e-05
epoch 15 training time: 13.894
---------------
2025-11-06 12:10:54.274240
current #epochs=16, #steps=495
Epoch: [16][5/33]	Per Sample Total Time 0.04571	Per Sample Data Time 0.04233	Per Sample DNN Time 0.00338	Train Loss 0.4467	
start validation
acc: 0.800000
AUC: 0.988010
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.192525
train_loss: 0.417133
valid_loss: 3.443891
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.673432436896142e-05
Epoch-16 lr: 1.673432436896142e-05
epoch 16 training time: 23.748
---------------
2025-11-06 12:11:18.022514
current #epochs=17, #steps=528
start validation
acc: 0.795000
AUC: 0.987436
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.167041
train_loss: 0.421626
valid_loss: 3.444222
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.4224175713617208e-05
Epoch-17 lr: 1.4224175713617208e-05
epoch 17 training time: 22.910
---------------
2025-11-06 12:11:40.932928
current #epochs=18, #steps=561
start validation
acc: 0.800000
AUC: 0.987328
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.162341
train_loss: 0.389915
valid_loss: 3.444894
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.2090549356574626e-05
Epoch-18 lr: 1.2090549356574626e-05
epoch 18 training time: 23.656
---------------
2025-11-06 12:12:04.588775
current #epochs=19, #steps=594
Epoch: [19][6/33]	Per Sample Total Time 0.04227	Per Sample Data Time 0.03903	Per Sample DNN Time 0.00324	Train Loss 0.3533	
start validation
acc: 0.805000
AUC: 0.988074
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.195421
train_loss: 0.381328
valid_loss: 3.443892
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.0276966953088432e-05
Epoch-19 lr: 1.0276966953088432e-05
epoch 19 training time: 23.664
---------------
2025-11-06 12:12:28.252895
current #epochs=20, #steps=627
start validation
acc: 0.802500
AUC: 0.987895
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.187345
train_loss: 0.369282
valid_loss: 3.444955
validation finished
normal learning rate scheduler step
Epoch-20 lr: 8.735421910125167e-06
Epoch-20 lr: 8.735421910125167e-06
epoch 20 training time: 23.543
---------------
2025-11-06 12:12:51.795508
current #epochs=21, #steps=660
start validation
acc: 0.800000
AUC: 0.988144
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.198623
train_loss: 0.372040
valid_loss: 3.444392
validation finished
normal learning rate scheduler step
Epoch-21 lr: 7.425108623606392e-06
Epoch-21 lr: 7.425108623606392e-06
epoch 21 training time: 24.214
---------------
2025-11-06 12:13:16.009819
current #epochs=22, #steps=693
Epoch: [22][7/33]	Per Sample Total Time 0.03715	Per Sample Data Time 0.03373	Per Sample DNN Time 0.00342	Train Loss 0.3550	
start validation
acc: 0.802500
AUC: 0.988489
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.214583
train_loss: 0.342657
valid_loss: 3.442956
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.3113423300654325e-06
Epoch-22 lr: 6.3113423300654325e-06
epoch 22 training time: 23.709
---------------
2025-11-06 12:13:39.718450
current #epochs=23, #steps=726
start validation
acc: 0.805000
AUC: 0.988259
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.203898
train_loss: 0.350895
valid_loss: 3.442486
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.3646409805556175e-06
Epoch-23 lr: 5.3646409805556175e-06
epoch 23 training time: 23.705
---------------
2025-11-06 12:14:03.423236
current #epochs=24, #steps=759
start validation
acc: 0.805000
AUC: 0.988495
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.214882
train_loss: 0.334781
valid_loss: 3.443803
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.559944833472275e-06
Epoch-24 lr: 4.559944833472275e-06
epoch 24 training time: 24.071
---------------
2025-11-06 12:14:27.494611
current #epochs=25, #steps=792
Epoch: [25][8/33]	Per Sample Total Time 0.03231	Per Sample Data Time 0.02882	Per Sample DNN Time 0.00349	Train Loss 0.3298	
start validation
acc: 0.807500
AUC: 0.988457
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.213088
train_loss: 0.325119
valid_loss: 3.443179
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.875953108451433e-06
Epoch-25 lr: 3.875953108451433e-06
epoch 25 training time: 23.468
---------------
2025-11-06 12:14:50.962674
current #epochs=26, #steps=825
start validation
acc: 0.807500
AUC: 0.988240
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.203016
train_loss: 0.329651
valid_loss: 3.442984
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.2945601421837183e-06
Epoch-26 lr: 3.2945601421837183e-06
epoch 26 training time: 23.241
---------------
2025-11-06 12:15:14.203890
current #epochs=27, #steps=858
start validation
acc: 0.800000
AUC: 0.988157
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.199207
train_loss: 0.320575
valid_loss: 3.442503
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.8003761208561607e-06
Epoch-27 lr: 2.8003761208561607e-06
epoch 27 training time: 22.999
---------------
2025-11-06 12:15:37.203422
current #epochs=28, #steps=891
Epoch: [28][9/33]	Per Sample Total Time 0.02888	Per Sample Data Time 0.02546	Per Sample DNN Time 0.00341	Train Loss 0.3206	
start validation
acc: 0.800000
AUC: 0.988125
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.197748
train_loss: 0.324378
valid_loss: 3.442634
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.3803197027277364e-06
Epoch-28 lr: 2.3803197027277364e-06
epoch 28 training time: 23.290
---------------
2025-11-06 12:16:00.493478
current #epochs=29, #steps=924
start validation
acc: 0.807500
AUC: 0.988342
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.207735
train_loss: 0.323276
valid_loss: 3.442031
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.0232717473185757e-06
Epoch-29 lr: 2.0232717473185757e-06
epoch 29 training time: 23.288
---------------
2025-11-06 12:16:23.782004
current #epochs=30, #steps=957
start validation
acc: 0.810000
AUC: 0.988380
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.209514
train_loss: 0.320897
valid_loss: 3.442183
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.7197809852207893e-06
Epoch-30 lr: 1.7197809852207893e-06
epoch 30 training time: 25.722
---------------
2025-11-06 12:16:49.503579
current #epochs=31, #steps=990
Epoch: [31][10/33]	Per Sample Total Time 0.02834	Per Sample Data Time 0.02496	Per Sample DNN Time 0.00338	Train Loss 0.3351	
start validation
acc: 0.807500
AUC: 0.988291
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.205371
train_loss: 0.326207
valid_loss: 3.442342
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.4618138374376709e-06
Epoch-31 lr: 1.4618138374376709e-06
epoch 31 training time: 24.133
---------------
2025-11-06 12:17:13.636369
current #epochs=32, #steps=1023
start validation
acc: 0.802500
AUC: 0.988361
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208624
train_loss: 0.313774
valid_loss: 3.442163
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.2425417618220202e-06
Epoch-32 lr: 1.2425417618220202e-06
epoch 32 training time: 24.615
---------------
2025-11-06 12:17:38.251711
current #epochs=33, #steps=1056
start validation
acc: 0.802500
AUC: 0.988406
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210703
train_loss: 0.328086
valid_loss: 3.442033
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.0561604975487172e-06
Epoch-33 lr: 1.0561604975487172e-06
epoch 33 training time: 24.127
---------------
2025-11-06 12:18:02.378439
current #epochs=34, #steps=1089
Epoch: [34][11/33]	Per Sample Total Time 0.02648	Per Sample Data Time 0.02333	Per Sample DNN Time 0.00315	Train Loss 0.3117	
start validation
acc: 0.807500
AUC: 0.988425
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.211596
train_loss: 0.318527
valid_loss: 3.441723
validation finished
normal learning rate scheduler step
Epoch-34 lr: 8.977364229164096e-07
Epoch-34 lr: 8.977364229164096e-07
epoch 34 training time: 23.943
---------------
2025-11-06 12:18:26.321286
current #epochs=35, #steps=1122
start validation
acc: 0.805000
AUC: 0.988406
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210703
train_loss: 0.318289
valid_loss: 3.441999
validation finished
normal learning rate scheduler step
Epoch-35 lr: 7.630759594789481e-07
Epoch-35 lr: 7.630759594789481e-07
epoch 35 training time: 23.249
---------------
2025-11-06 12:18:49.570082
current #epochs=36, #steps=1155
start validation
acc: 0.802500
AUC: 0.988297
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.205666
train_loss: 0.311516
valid_loss: 3.442278
validation finished
normal learning rate scheduler step
Epoch-36 lr: 6.486145655571059e-07
Epoch-36 lr: 6.486145655571059e-07
epoch 36 training time: 22.616
---------------
2025-11-06 12:19:12.186191
current #epochs=37, #steps=1188
Epoch: [37][12/33]	Per Sample Total Time 0.02399	Per Sample Data Time 0.02081	Per Sample DNN Time 0.00318	Train Loss 0.2963	
start validation
acc: 0.805000
AUC: 0.988342
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.207735
train_loss: 0.309038
valid_loss: 3.442222
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.5132238072354e-07
Epoch-37 lr: 5.5132238072354e-07
epoch 37 training time: 23.136
---------------
2025-11-06 12:19:35.321966
current #epochs=38, #steps=1221
start validation
acc: 0.805000
AUC: 0.988361
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208624
train_loss: 0.313413
valid_loss: 3.442191
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.68624023615009e-07
Epoch-38 lr: 4.68624023615009e-07
epoch 38 training time: 23.783
---------------
2025-11-06 12:19:59.104923
current #epochs=39, #steps=1254
start validation
acc: 0.805000
AUC: 0.988355
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208328
train_loss: 0.323838
valid_loss: 3.442247
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.983304200727576e-07
Epoch-39 lr: 3.983304200727576e-07
epoch 39 training time: 23.353
---------------
2025-11-06 12:20:22.458045
current #epochs=40, #steps=1287
Epoch: [40][13/33]	Per Sample Total Time 0.02263	Per Sample Data Time 0.01949	Per Sample DNN Time 0.00314	Train Loss 0.3178	
start validation
acc: 0.807500
AUC: 0.988361
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208624
train_loss: 0.312533
valid_loss: 3.442149
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.38580857061844e-07
Epoch-40 lr: 3.38580857061844e-07
epoch 40 training time: 23.349
---------------
2025-11-06 12:20:45.806862
current #epochs=41, #steps=1320
start validation
acc: 0.807500
AUC: 0.988348
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208031
train_loss: 0.299425
valid_loss: 3.442191
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.877937285025674e-07
Epoch-41 lr: 2.877937285025674e-07
epoch 41 training time: 21.240
---------------
2025-11-06 12:21:07.046525
current #epochs=42, #steps=1353
start validation
acc: 0.807500
AUC: 0.988329
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.207143
train_loss: 0.310863
valid_loss: 3.442210
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.4462466922718226e-07
Epoch-42 lr: 2.4462466922718226e-07
epoch 42 training time: 14.154
---------------
2025-11-06 12:21:21.200165
current #epochs=43, #steps=1386
Epoch: [43][14/33]	Per Sample Total Time 0.01082	Per Sample Data Time 0.00762	Per Sample DNN Time 0.00320	Train Loss 0.3024	
start validation
acc: 0.807500
AUC: 0.988355
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208328
train_loss: 0.303716
valid_loss: 3.442127
validation finished
normal learning rate scheduler step
Epoch-43 lr: 2.079309688431049e-07
Epoch-43 lr: 2.079309688431049e-07
epoch 43 training time: 14.052
---------------
2025-11-06 12:21:35.252383
current #epochs=44, #steps=1419
start validation
acc: 0.807500
AUC: 0.988393
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210109
train_loss: 0.315546
valid_loss: 3.442111
validation finished
normal learning rate scheduler step
Epoch-44 lr: 1.7674132351663916e-07
Epoch-44 lr: 1.7674132351663916e-07
epoch 44 training time: 13.677
---------------
2025-11-06 12:21:48.929605
current #epochs=45, #steps=1452
start validation
acc: 0.807500
AUC: 0.988393
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210109
train_loss: 0.298810
valid_loss: 3.442127
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.5023012498914328e-07
Epoch-45 lr: 1.5023012498914328e-07
epoch 45 training time: 13.739
---------------
2025-11-06 12:22:02.668640
current #epochs=46, #steps=1485
Epoch: [46][15/33]	Per Sample Total Time 0.01055	Per Sample Data Time 0.00712	Per Sample DNN Time 0.00343	Train Loss 0.2848	
start validation
acc: 0.807500
AUC: 0.988374
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.209218
train_loss: 0.306951
valid_loss: 3.442141
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.276956062407718e-07
Epoch-46 lr: 1.276956062407718e-07
epoch 46 training time: 14.192
---------------
2025-11-06 12:22:16.860413
current #epochs=47, #steps=1518
start validation
acc: 0.807500
AUC: 0.988374
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.209218
train_loss: 0.306914
valid_loss: 3.442151
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.0854126530465602e-07
Epoch-47 lr: 1.0854126530465602e-07
epoch 47 training time: 14.135
---------------
2025-11-06 12:22:30.995264
current #epochs=48, #steps=1551
start validation
acc: 0.807500
AUC: 0.988380
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.209514
train_loss: 0.319223
valid_loss: 3.442150
validation finished
normal learning rate scheduler step
Epoch-48 lr: 9.226007550895761e-08
Epoch-48 lr: 9.226007550895761e-08
epoch 48 training time: 14.065
---------------
2025-11-06 12:22:45.060452
current #epochs=49, #steps=1584
Epoch: [49][16/33]	Per Sample Total Time 0.01038	Per Sample Data Time 0.00691	Per Sample DNN Time 0.00347	Train Loss 0.3068	
start validation
acc: 0.807500
AUC: 0.988393
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210109
train_loss: 0.308325
valid_loss: 3.442141
validation finished
normal learning rate scheduler step
Epoch-49 lr: 7.842106418261397e-08
Epoch-49 lr: 7.842106418261397e-08
epoch 49 training time: 14.405
---------------
2025-11-06 12:22:59.465090
current #epochs=50, #steps=1617
start validation
acc: 0.807500
AUC: 0.988386
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.209811
train_loss: 0.313815
valid_loss: 3.442126
validation finished
normal learning rate scheduler step
Epoch-50 lr: 6.665790455522187e-08
Epoch-50 lr: 6.665790455522187e-08
epoch 50 training time: 14.600
now process fold3
I am process 4129039, running on scotia07.inf.ed.ac.uk: starting (Thu Nov  6 12:23:57 2025)
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process esc50
use dataset mean -6.627 and std 5.358 to normalize the input.
now use noise augmentation
number of classes is 50
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process esc50
use dataset mean -6.627 and std 5.358 to normalize the input.
number of classes is 50
Now train with esc50 with 1600 training samples, evaluate with 400 samples
now load a SSL pretrained models from ./SSAST-Tiny-Patch-400.pth
pretraining patch split stride: frequency=16, time=16
pretraining patch shape: frequency=16, time=16
pretraining patch array dimension: frequency=8, time=64
pretraining number of patches=512
fine-tuning patch split stride: frequncey=10, time=10
fine-tuning number of patches=600

Creating experiment directory: ./exp/test01-esc50-f10-16-t10-16-b48-lr1e-4-ft_avgtok-tiny--SSAST-Tiny-Patch-400-1x-noiseTrue/fold3
Now starting fine-tuning for 50 epochs
running on cuda
Total parameter number is : 5.900 million
Total trainable parameter number is : 5.900 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.010 million
Total base parameter number is : 5.890 million
now training with esc50, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x73dac25e3e60>
The learning rate scheduler starts at 6 epoch with decay rate of 0.850 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2025-11-06 12:23:58.612601
current #epochs=1, #steps=0
start validation
acc: 0.150000
AUC: 0.842398
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 1.420383
train_loss: 3.735748
valid_loss: 3.773903
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0001
Epoch-1 lr: 0.0001
epoch 1 training time: 18.812
---------------
2025-11-06 12:24:17.425951
current #epochs=2, #steps=33
start validation
acc: 0.312500
AUC: 0.920536
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 1.992180
train_loss: 3.170139
valid_loss: 3.650101
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0001
Epoch-2 lr: 0.0001
epoch 2 training time: 14.682
---------------
2025-11-06 12:24:32.108437
current #epochs=3, #steps=66
start validation
acc: 0.472500
AUC: 0.952232
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.357342
train_loss: 2.650286
valid_loss: 3.568219
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0001
Epoch-3 lr: 0.0001
epoch 3 training time: 14.358
---------------
2025-11-06 12:24:46.466066
current #epochs=4, #steps=99
Epoch: [4][1/33]	Per Sample Total Time 0.04929	Per Sample Data Time 0.04576	Per Sample DNN Time 0.00353	Train Loss 2.4293	
start validation
acc: 0.560000
AUC: 0.967054
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.600953
train_loss: 2.165501
valid_loss: 3.519365
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0001
Epoch-4 lr: 0.0001
epoch 4 training time: 14.335
---------------
2025-11-06 12:25:00.801290
current #epochs=5, #steps=132
start validation
acc: 0.617500
AUC: 0.975651
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.787723
train_loss: 1.752117
valid_loss: 3.488573
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0001
Epoch-5 lr: 0.0001
epoch 5 training time: 14.095
---------------
2025-11-06 12:25:14.896330
current #epochs=6, #steps=165
start validation
acc: 0.665000
AUC: 0.978348
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.857800
train_loss: 1.455932
valid_loss: 3.478130
validation finished
normal learning rate scheduler step
Epoch-6 lr: 8.5e-05
Epoch-6 lr: 8.5e-05
epoch 6 training time: 14.275
---------------
2025-11-06 12:25:29.170996
current #epochs=7, #steps=198
Epoch: [7][2/33]	Per Sample Total Time 0.03712	Per Sample Data Time 0.03367	Per Sample DNN Time 0.00345	Train Loss 1.2151	
start validation
acc: 0.720000
AUC: 0.982774
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.990704
train_loss: 1.186487
valid_loss: 3.462044
validation finished
normal learning rate scheduler step
Epoch-7 lr: 7.225000000000001e-05
Epoch-7 lr: 7.225000000000001e-05
epoch 7 training time: 14.423
---------------
2025-11-06 12:25:43.593614
current #epochs=8, #steps=231
start validation
acc: 0.767500
AUC: 0.986365
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.122054
train_loss: 0.988641
valid_loss: 3.456430
validation finished
normal learning rate scheduler step
Epoch-8 lr: 6.141250000000001e-05
Epoch-8 lr: 6.141250000000001e-05
epoch 8 training time: 14.458
---------------
2025-11-06 12:25:58.052035
current #epochs=9, #steps=264
start validation
acc: 0.770000
AUC: 0.983667
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.020996
train_loss: 0.848931
valid_loss: 3.454055
validation finished
normal learning rate scheduler step
Epoch-9 lr: 5.2200625000000005e-05
Epoch-9 lr: 5.2200625000000005e-05
epoch 9 training time: 14.433
---------------
2025-11-06 12:26:12.485414
current #epochs=10, #steps=297
Epoch: [10][3/33]	Per Sample Total Time 0.03375	Per Sample Data Time 0.03050	Per Sample DNN Time 0.00325	Train Loss 0.7486	
start validation
acc: 0.772500
AUC: 0.984369
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.045809
train_loss: 0.747917
valid_loss: 3.449596
validation finished
normal learning rate scheduler step
Epoch-10 lr: 4.437053125e-05
Epoch-10 lr: 4.437053125e-05
epoch 10 training time: 14.760
---------------
2025-11-06 12:26:27.245859
current #epochs=11, #steps=330
start validation
acc: 0.790000
AUC: 0.986677
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.134850
train_loss: 0.660997
valid_loss: 3.449819
validation finished
normal learning rate scheduler step
Epoch-11 lr: 3.77149515625e-05
Epoch-11 lr: 3.77149515625e-05
epoch 11 training time: 14.461
---------------
2025-11-06 12:26:41.706888
current #epochs=12, #steps=363
start validation
acc: 0.785000
AUC: 0.987353
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.163444
train_loss: 0.591505
valid_loss: 3.446100
validation finished
normal learning rate scheduler step
Epoch-12 lr: 3.2057708828124995e-05
Epoch-12 lr: 3.2057708828124995e-05
epoch 12 training time: 14.013
---------------
2025-11-06 12:26:55.720182
current #epochs=13, #steps=396
Epoch: [13][4/33]	Per Sample Total Time 0.02387	Per Sample Data Time 0.02033	Per Sample DNN Time 0.00354	Train Loss 0.5511	
start validation
acc: 0.795000
AUC: 0.987838
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.184771
train_loss: 0.528715
valid_loss: 3.444436
validation finished
normal learning rate scheduler step
Epoch-13 lr: 2.7249052503906245e-05
Epoch-13 lr: 2.7249052503906245e-05
epoch 13 training time: 14.250
---------------
2025-11-06 12:27:09.969865
current #epochs=14, #steps=429
start validation
acc: 0.805000
AUC: 0.987085
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.151960
train_loss: 0.490656
valid_loss: 3.444422
validation finished
normal learning rate scheduler step
Epoch-14 lr: 2.3161694628320308e-05
Epoch-14 lr: 2.3161694628320308e-05
epoch 14 training time: 14.194
---------------
2025-11-06 12:27:24.163396
current #epochs=15, #steps=462
start validation
acc: 0.795000
AUC: 0.987341
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.162892
train_loss: 0.457138
valid_loss: 3.443153
validation finished
normal learning rate scheduler step
Epoch-15 lr: 1.9687440434072263e-05
Epoch-15 lr: 1.9687440434072263e-05
epoch 15 training time: 14.484
---------------
2025-11-06 12:27:38.647402
current #epochs=16, #steps=495
Epoch: [16][5/33]	Per Sample Total Time 0.02082	Per Sample Data Time 0.01712	Per Sample DNN Time 0.00370	Train Loss 0.3971	
start validation
acc: 0.795000
AUC: 0.986926
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.145221
train_loss: 0.432768
valid_loss: 3.443672
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.673432436896142e-05
Epoch-16 lr: 1.673432436896142e-05
epoch 16 training time: 14.058
---------------
2025-11-06 12:27:52.705160
current #epochs=17, #steps=528
start validation
acc: 0.812500
AUC: 0.986658
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.134059
train_loss: 0.427657
valid_loss: 3.442946
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.4224175713617208e-05
Epoch-17 lr: 1.4224175713617208e-05
epoch 17 training time: 14.218
---------------
2025-11-06 12:28:06.923627
current #epochs=18, #steps=561
start validation
acc: 0.820000
AUC: 0.987506
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.170101
train_loss: 0.405584
valid_loss: 3.443004
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.2090549356574626e-05
Epoch-18 lr: 1.2090549356574626e-05
epoch 18 training time: 14.297
---------------
2025-11-06 12:28:21.220981
current #epochs=19, #steps=594
Epoch: [19][6/33]	Per Sample Total Time 0.01872	Per Sample Data Time 0.01527	Per Sample DNN Time 0.00345	Train Loss 0.4113	
start validation
acc: 0.815000
AUC: 0.988367
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208921
train_loss: 0.393562
valid_loss: 3.441833
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.0276966953088432e-05
Epoch-19 lr: 1.0276966953088432e-05
epoch 19 training time: 14.035
---------------
2025-11-06 12:28:35.255855
current #epochs=20, #steps=627
start validation
acc: 0.812500
AUC: 0.988093
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.196293
train_loss: 0.371597
valid_loss: 3.440677
validation finished
normal learning rate scheduler step
Epoch-20 lr: 8.735421910125167e-06
Epoch-20 lr: 8.735421910125167e-06
epoch 20 training time: 14.151
---------------
2025-11-06 12:28:49.406855
current #epochs=21, #steps=660
start validation
acc: 0.812500
AUC: 0.987915
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.188205
train_loss: 0.371780
valid_loss: 3.441564
validation finished
normal learning rate scheduler step
Epoch-21 lr: 7.425108623606392e-06
Epoch-21 lr: 7.425108623606392e-06
epoch 21 training time: 14.187
---------------
2025-11-06 12:29:03.593687
current #epochs=22, #steps=693
Epoch: [22][7/33]	Per Sample Total Time 0.01585	Per Sample Data Time 0.01252	Per Sample DNN Time 0.00332	Train Loss 0.3632	
start validation
acc: 0.810000
AUC: 0.987864
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.185913
train_loss: 0.352924
valid_loss: 3.441668
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.3113423300654325e-06
Epoch-22 lr: 6.3113423300654325e-06
epoch 22 training time: 14.151
---------------
2025-11-06 12:29:17.745309
current #epochs=23, #steps=726
start validation
acc: 0.815000
AUC: 0.987946
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.189642
train_loss: 0.343643
valid_loss: 3.441494
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.3646409805556175e-06
Epoch-23 lr: 5.3646409805556175e-06
epoch 23 training time: 13.813
---------------
2025-11-06 12:29:31.558149
current #epochs=24, #steps=759
start validation
acc: 0.812500
AUC: 0.988048
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.194261
train_loss: 0.342394
valid_loss: 3.441027
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.559944833472275e-06
Epoch-24 lr: 4.559944833472275e-06
epoch 24 training time: 13.805
---------------
2025-11-06 12:29:45.363650
current #epochs=25, #steps=792
Epoch: [25][8/33]	Per Sample Total Time 0.01497	Per Sample Data Time 0.01149	Per Sample DNN Time 0.00348	Train Loss 0.3562	
start validation
acc: 0.802500
AUC: 0.988010
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.192525
train_loss: 0.344018
valid_loss: 3.441186
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.875953108451433e-06
Epoch-25 lr: 3.875953108451433e-06
epoch 25 training time: 14.026
---------------
2025-11-06 12:29:59.389856
current #epochs=26, #steps=825
start validation
acc: 0.815000
AUC: 0.988029
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.193393
train_loss: 0.352138
valid_loss: 3.441371
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.2945601421837183e-06
Epoch-26 lr: 3.2945601421837183e-06
epoch 26 training time: 15.191
---------------
2025-11-06 12:30:14.580608
current #epochs=27, #steps=858
start validation
acc: 0.822500
AUC: 0.988195
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.200962
train_loss: 0.340402
valid_loss: 3.440769
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.8003761208561607e-06
Epoch-27 lr: 2.8003761208561607e-06
epoch 27 training time: 13.976
---------------
2025-11-06 12:30:28.557070
current #epochs=28, #steps=891
Epoch: [28][9/33]	Per Sample Total Time 0.01436	Per Sample Data Time 0.01101	Per Sample DNN Time 0.00336	Train Loss 0.3281	
start validation
acc: 0.815000
AUC: 0.988374
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.209218
train_loss: 0.338333
valid_loss: 3.440227
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.3803197027277364e-06
Epoch-28 lr: 2.3803197027277364e-06
epoch 28 training time: 14.141
---------------
2025-11-06 12:30:42.698466
current #epochs=29, #steps=924
start validation
acc: 0.812500
AUC: 0.988361
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208624
train_loss: 0.334191
valid_loss: 3.440467
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.0232717473185757e-06
Epoch-29 lr: 2.0232717473185757e-06
epoch 29 training time: 14.311
---------------
2025-11-06 12:30:57.009734
current #epochs=30, #steps=957
start validation
acc: 0.812500
AUC: 0.988246
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.203310
train_loss: 0.319226
valid_loss: 3.440606
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.7197809852207893e-06
Epoch-30 lr: 1.7197809852207893e-06
epoch 30 training time: 14.286
---------------
2025-11-06 12:31:11.295545
current #epochs=31, #steps=990
Epoch: [31][10/33]	Per Sample Total Time 0.01373	Per Sample Data Time 0.01033	Per Sample DNN Time 0.00339	Train Loss 0.3272	
start validation
acc: 0.812500
AUC: 0.988348
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208031
train_loss: 0.332712
valid_loss: 3.440377
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.4618138374376709e-06
Epoch-31 lr: 1.4618138374376709e-06
epoch 31 training time: 14.260
---------------
2025-11-06 12:31:25.556015
current #epochs=32, #steps=1023
start validation
acc: 0.820000
AUC: 0.988431
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.211894
train_loss: 0.323797
valid_loss: 3.440437
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.2425417618220202e-06
Epoch-32 lr: 1.2425417618220202e-06
epoch 32 training time: 14.190
---------------
2025-11-06 12:31:39.746354
current #epochs=33, #steps=1056
start validation
acc: 0.820000
AUC: 0.988508
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.215482
train_loss: 0.316626
valid_loss: 3.440307
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.0561604975487172e-06
Epoch-33 lr: 1.0561604975487172e-06
epoch 33 training time: 14.316
---------------
2025-11-06 12:31:54.061967
current #epochs=34, #steps=1089
Epoch: [34][11/33]	Per Sample Total Time 0.01160	Per Sample Data Time 0.00814	Per Sample DNN Time 0.00346	Train Loss 0.3289	
start validation
acc: 0.815000
AUC: 0.988431
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.211894
train_loss: 0.322756
valid_loss: 3.440361
validation finished
normal learning rate scheduler step
Epoch-34 lr: 8.977364229164096e-07
Epoch-34 lr: 8.977364229164096e-07
epoch 34 training time: 13.784
---------------
2025-11-06 12:32:07.846485
current #epochs=35, #steps=1122
start validation
acc: 0.815000
AUC: 0.988348
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208031
train_loss: 0.326768
valid_loss: 3.440304
validation finished
normal learning rate scheduler step
Epoch-35 lr: 7.630759594789481e-07
Epoch-35 lr: 7.630759594789481e-07
epoch 35 training time: 14.451
---------------
2025-11-06 12:32:22.297326
current #epochs=36, #steps=1155
start validation
acc: 0.820000
AUC: 0.988367
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208921
train_loss: 0.322642
valid_loss: 3.440366
validation finished
normal learning rate scheduler step
Epoch-36 lr: 6.486145655571059e-07
Epoch-36 lr: 6.486145655571059e-07
epoch 36 training time: 14.283
---------------
2025-11-06 12:32:36.580668
current #epochs=37, #steps=1188
Epoch: [37][12/33]	Per Sample Total Time 0.01276	Per Sample Data Time 0.00959	Per Sample DNN Time 0.00317	Train Loss 0.3225	
start validation
acc: 0.820000
AUC: 0.988329
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.207143
train_loss: 0.318311
valid_loss: 3.440461
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.5132238072354e-07
Epoch-37 lr: 5.5132238072354e-07
epoch 37 training time: 14.351
---------------
2025-11-06 12:32:50.931985
current #epochs=38, #steps=1221
start validation
acc: 0.822500
AUC: 0.988278
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.204781
train_loss: 0.315209
valid_loss: 3.440485
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.68624023615009e-07
Epoch-38 lr: 4.68624023615009e-07
epoch 38 training time: 14.245
---------------
2025-11-06 12:33:05.176881
current #epochs=39, #steps=1254
start validation
acc: 0.822500
AUC: 0.988355
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208328
train_loss: 0.311971
valid_loss: 3.440303
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.983304200727576e-07
Epoch-39 lr: 3.983304200727576e-07
epoch 39 training time: 13.858
---------------
2025-11-06 12:33:19.034797
current #epochs=40, #steps=1287
Epoch: [40][13/33]	Per Sample Total Time 0.01156	Per Sample Data Time 0.00840	Per Sample DNN Time 0.00317	Train Loss 0.3261	
start validation
acc: 0.820000
AUC: 0.988361
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208624
train_loss: 0.321378
valid_loss: 3.440291
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.38580857061844e-07
Epoch-40 lr: 3.38580857061844e-07
epoch 40 training time: 14.964
---------------
2025-11-06 12:33:33.998593
current #epochs=41, #steps=1320
start validation
acc: 0.815000
AUC: 0.988393
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210109
train_loss: 0.314174
valid_loss: 3.440259
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.877937285025674e-07
Epoch-41 lr: 2.877937285025674e-07
epoch 41 training time: 14.053
---------------
2025-11-06 12:33:48.051266
current #epochs=42, #steps=1353
start validation
acc: 0.815000
AUC: 0.988386
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.209811
train_loss: 0.315458
valid_loss: 3.440273
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.4462466922718226e-07
Epoch-42 lr: 2.4462466922718226e-07
epoch 42 training time: 14.203
---------------
2025-11-06 12:34:02.254188
current #epochs=43, #steps=1386
Epoch: [43][14/33]	Per Sample Total Time 0.01080	Per Sample Data Time 0.00738	Per Sample DNN Time 0.00343	Train Loss 0.3095	
start validation
acc: 0.817500
AUC: 0.988399
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210406
train_loss: 0.312433
valid_loss: 3.440240
validation finished
normal learning rate scheduler step
Epoch-43 lr: 2.079309688431049e-07
Epoch-43 lr: 2.079309688431049e-07
epoch 43 training time: 14.024
---------------
2025-11-06 12:34:16.277907
current #epochs=44, #steps=1419
start validation
acc: 0.812500
AUC: 0.988367
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.208921
train_loss: 0.315894
valid_loss: 3.440234
validation finished
normal learning rate scheduler step
Epoch-44 lr: 1.7674132351663916e-07
Epoch-44 lr: 1.7674132351663916e-07
epoch 44 training time: 14.374
---------------
2025-11-06 12:34:30.651553
current #epochs=45, #steps=1452
start validation
acc: 0.810000
AUC: 0.988425
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.211596
train_loss: 0.309006
valid_loss: 3.440205
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.5023012498914328e-07
Epoch-45 lr: 1.5023012498914328e-07
epoch 45 training time: 14.105
---------------
2025-11-06 12:34:44.757115
current #epochs=46, #steps=1485
Epoch: [46][15/33]	Per Sample Total Time 0.00971	Per Sample Data Time 0.00637	Per Sample DNN Time 0.00334	Train Loss 0.3015	
start validation
acc: 0.812500
AUC: 0.988406
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210703
train_loss: 0.312841
valid_loss: 3.440176
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.276956062407718e-07
Epoch-46 lr: 1.276956062407718e-07
epoch 46 training time: 13.737
---------------
2025-11-06 12:34:58.493833
current #epochs=47, #steps=1518
start validation
acc: 0.810000
AUC: 0.988406
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210703
train_loss: 0.312671
valid_loss: 3.440160
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.0854126530465602e-07
Epoch-47 lr: 1.0854126530465602e-07
epoch 47 training time: 13.880
---------------
2025-11-06 12:35:12.373683
current #epochs=48, #steps=1551
start validation
acc: 0.812500
AUC: 0.988393
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210109
train_loss: 0.307526
valid_loss: 3.440154
validation finished
normal learning rate scheduler step
Epoch-48 lr: 9.226007550895761e-08
Epoch-48 lr: 9.226007550895761e-08
epoch 48 training time: 13.927
---------------
2025-11-06 12:35:26.300566
current #epochs=49, #steps=1584
Epoch: [49][16/33]	Per Sample Total Time 0.01012	Per Sample Data Time 0.00692	Per Sample DNN Time 0.00320	Train Loss 0.2909	
start validation
acc: 0.812500
AUC: 0.988386
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.209811
train_loss: 0.306268
valid_loss: 3.440152
validation finished
normal learning rate scheduler step
Epoch-49 lr: 7.842106418261397e-08
Epoch-49 lr: 7.842106418261397e-08
epoch 49 training time: 13.865
---------------
2025-11-06 12:35:40.165853
current #epochs=50, #steps=1617
start validation
acc: 0.812500
AUC: 0.988386
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.209811
train_loss: 0.313271
valid_loss: 3.440148
validation finished
normal learning rate scheduler step
Epoch-50 lr: 6.665790455522187e-08
Epoch-50 lr: 6.665790455522187e-08
epoch 50 training time: 13.988
now process fold4
I am process 4136430, running on scotia07.inf.ed.ac.uk: starting (Thu Nov  6 12:36:31 2025)
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process esc50
use dataset mean -6.627 and std 5.358 to normalize the input.
now use noise augmentation
number of classes is 50
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process esc50
use dataset mean -6.627 and std 5.358 to normalize the input.
number of classes is 50
Now train with esc50 with 1600 training samples, evaluate with 400 samples
now load a SSL pretrained models from ./SSAST-Tiny-Patch-400.pth
pretraining patch split stride: frequency=16, time=16
pretraining patch shape: frequency=16, time=16
pretraining patch array dimension: frequency=8, time=64
pretraining number of patches=512
fine-tuning patch split stride: frequncey=10, time=10
fine-tuning number of patches=600

Creating experiment directory: ./exp/test01-esc50-f10-16-t10-16-b48-lr1e-4-ft_avgtok-tiny--SSAST-Tiny-Patch-400-1x-noiseTrue/fold4
Now starting fine-tuning for 50 epochs
running on cuda
Total parameter number is : 5.900 million
Total trainable parameter number is : 5.900 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.010 million
Total base parameter number is : 5.890 million
now training with esc50, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x79af85a9f860>
The learning rate scheduler starts at 6 epoch with decay rate of 0.850 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2025-11-06 12:36:33.016814
current #epochs=1, #steps=0
start validation
acc: 0.127500
AUC: 0.792672
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 1.153614
train_loss: 3.779518
valid_loss: 3.802807
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0001
Epoch-1 lr: 0.0001
epoch 1 training time: 16.423
---------------
2025-11-06 12:36:49.441367
current #epochs=2, #steps=33
start validation
acc: 0.250000
AUC: 0.885032
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 1.697796
train_loss: 3.248951
valid_loss: 3.692920
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0001
Epoch-2 lr: 0.0001
epoch 2 training time: 14.418
---------------
2025-11-06 12:37:03.859244
current #epochs=3, #steps=66
start validation
acc: 0.362500
AUC: 0.927328
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.059342
train_loss: 2.777896
valid_loss: 3.614242
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0001
Epoch-3 lr: 0.0001
epoch 3 training time: 14.428
---------------
2025-11-06 12:37:18.287277
current #epochs=4, #steps=99
Epoch: [4][1/33]	Per Sample Total Time 0.05641	Per Sample Data Time 0.05289	Per Sample DNN Time 0.00352	Train Loss 2.5128	
start validation
acc: 0.450000
AUC: 0.956913
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.426702
train_loss: 2.349991
valid_loss: 3.562825
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0001
Epoch-4 lr: 0.0001
epoch 4 training time: 14.141
---------------
2025-11-06 12:37:32.428152
current #epochs=5, #steps=132
start validation
acc: 0.535000
AUC: 0.969356
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.646573
train_loss: 1.960018
valid_loss: 3.516188
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0001
Epoch-5 lr: 0.0001
epoch 5 training time: 13.992
---------------
2025-11-06 12:37:46.419986
current #epochs=6, #steps=165
start validation
acc: 0.645000
AUC: 0.977927
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.846398
train_loss: 1.618009
valid_loss: 3.490783
validation finished
normal learning rate scheduler step
Epoch-6 lr: 8.5e-05
Epoch-6 lr: 8.5e-05
epoch 6 training time: 13.696
---------------
2025-11-06 12:38:00.115642
current #epochs=7, #steps=198
Epoch: [7][2/33]	Per Sample Total Time 0.03754	Per Sample Data Time 0.03400	Per Sample DNN Time 0.00354	Train Loss 1.3498	
start validation
acc: 0.675000
AUC: 0.980893
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.931027
train_loss: 1.328749
valid_loss: 3.469468
validation finished
normal learning rate scheduler step
Epoch-7 lr: 7.225000000000001e-05
Epoch-7 lr: 7.225000000000001e-05
epoch 7 training time: 13.392
---------------
2025-11-06 12:38:13.507353
current #epochs=8, #steps=231
start validation
acc: 0.695000
AUC: 0.983221
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.005678
train_loss: 1.178051
valid_loss: 3.465277
validation finished
normal learning rate scheduler step
Epoch-8 lr: 6.141250000000001e-05
Epoch-8 lr: 6.141250000000001e-05
epoch 8 training time: 13.761
---------------
2025-11-06 12:38:27.268667
current #epochs=9, #steps=264
start validation
acc: 0.700000
AUC: 0.985236
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.077843
train_loss: 1.024051
valid_loss: 3.458878
validation finished
normal learning rate scheduler step
Epoch-9 lr: 5.2200625000000005e-05
Epoch-9 lr: 5.2200625000000005e-05
epoch 9 training time: 14.004
---------------
2025-11-06 12:38:41.272707
current #epochs=10, #steps=297
Epoch: [10][3/33]	Per Sample Total Time 0.03157	Per Sample Data Time 0.02834	Per Sample DNN Time 0.00323	Train Loss 0.9210	
start validation
acc: 0.747500
AUC: 0.985344
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.081961
train_loss: 0.879465
valid_loss: 3.454958
validation finished
normal learning rate scheduler step
Epoch-10 lr: 4.437053125e-05
Epoch-10 lr: 4.437053125e-05
epoch 10 training time: 14.005
---------------
2025-11-06 12:38:55.277799
current #epochs=11, #steps=330
start validation
acc: 0.747500
AUC: 0.986250
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.117416
train_loss: 0.772600
valid_loss: 3.454369
validation finished
normal learning rate scheduler step
Epoch-11 lr: 3.77149515625e-05
Epoch-11 lr: 3.77149515625e-05
epoch 11 training time: 13.381
---------------
2025-11-06 12:39:08.658783
current #epochs=12, #steps=363
start validation
acc: 0.752500
AUC: 0.986977
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.147370
train_loss: 0.684644
valid_loss: 3.453254
validation finished
normal learning rate scheduler step
Epoch-12 lr: 3.2057708828124995e-05
Epoch-12 lr: 3.2057708828124995e-05
epoch 12 training time: 13.820
---------------
2025-11-06 12:39:22.478400
current #epochs=13, #steps=396
Epoch: [13][4/33]	Per Sample Total Time 0.02063	Per Sample Data Time 0.01737	Per Sample DNN Time 0.00326	Train Loss 0.6237	
start validation
acc: 0.765000
AUC: 0.986983
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.147639
train_loss: 0.636305
valid_loss: 3.447287
validation finished
normal learning rate scheduler step
Epoch-13 lr: 2.7249052503906245e-05
Epoch-13 lr: 2.7249052503906245e-05
epoch 13 training time: 13.950
---------------
2025-11-06 12:39:36.428372
current #epochs=14, #steps=429
start validation
acc: 0.787500
AUC: 0.987251
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.159044
train_loss: 0.599180
valid_loss: 3.446015
validation finished
normal learning rate scheduler step
Epoch-14 lr: 2.3161694628320308e-05
Epoch-14 lr: 2.3161694628320308e-05
epoch 14 training time: 14.278
---------------
2025-11-06 12:39:50.706056
current #epochs=15, #steps=462
start validation
acc: 0.787500
AUC: 0.987589
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.173736
train_loss: 0.536646
valid_loss: 3.445813
validation finished
normal learning rate scheduler step
Epoch-15 lr: 1.9687440434072263e-05
Epoch-15 lr: 1.9687440434072263e-05
epoch 15 training time: 13.977
---------------
2025-11-06 12:40:04.683151
current #epochs=16, #steps=495
Epoch: [16][5/33]	Per Sample Total Time 0.02059	Per Sample Data Time 0.01731	Per Sample DNN Time 0.00328	Train Loss 0.5215	
start validation
acc: 0.795000
AUC: 0.987723
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.179654
train_loss: 0.525372
valid_loss: 3.444716
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.673432436896142e-05
Epoch-16 lr: 1.673432436896142e-05
epoch 16 training time: 13.883
---------------
2025-11-06 12:40:18.566621
current #epochs=17, #steps=528
start validation
acc: 0.780000
AUC: 0.987519
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.170659
train_loss: 0.494918
valid_loss: 3.445826
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.4224175713617208e-05
Epoch-17 lr: 1.4224175713617208e-05
epoch 17 training time: 13.507
---------------
2025-11-06 12:40:32.073688
current #epochs=18, #steps=561
start validation
acc: 0.795000
AUC: 0.988393
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210109
train_loss: 0.470905
valid_loss: 3.443045
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.2090549356574626e-05
Epoch-18 lr: 1.2090549356574626e-05
epoch 18 training time: 13.536
---------------
2025-11-06 12:40:45.609849
current #epochs=19, #steps=594
Epoch: [19][6/33]	Per Sample Total Time 0.01976	Per Sample Data Time 0.01648	Per Sample DNN Time 0.00328	Train Loss 0.4851	
start validation
acc: 0.795000
AUC: 0.987615
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.174859
train_loss: 0.475863
valid_loss: 3.444845
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.0276966953088432e-05
Epoch-19 lr: 1.0276966953088432e-05
epoch 19 training time: 14.377
---------------
2025-11-06 12:40:59.987327
current #epochs=20, #steps=627
start validation
acc: 0.792500
AUC: 0.987991
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.191659
train_loss: 0.434786
valid_loss: 3.444033
validation finished
normal learning rate scheduler step
Epoch-20 lr: 8.735421910125167e-06
Epoch-20 lr: 8.735421910125167e-06
epoch 20 training time: 14.245
---------------
2025-11-06 12:41:14.232575
current #epochs=21, #steps=660
start validation
acc: 0.797500
AUC: 0.988068
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.195131
train_loss: 0.432258
valid_loss: 3.443867
validation finished
normal learning rate scheduler step
Epoch-21 lr: 7.425108623606392e-06
Epoch-21 lr: 7.425108623606392e-06
epoch 21 training time: 13.866
---------------
2025-11-06 12:41:28.098901
current #epochs=22, #steps=693
Epoch: [22][7/33]	Per Sample Total Time 0.01574	Per Sample Data Time 0.01240	Per Sample DNN Time 0.00334	Train Loss 0.4434	
start validation
acc: 0.782500
AUC: 0.988151
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.198915
train_loss: 0.418162
valid_loss: 3.443348
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.3113423300654325e-06
Epoch-22 lr: 6.3113423300654325e-06
epoch 22 training time: 13.536
---------------
2025-11-06 12:41:41.634674
current #epochs=23, #steps=726
start validation
acc: 0.797500
AUC: 0.988450
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.212789
train_loss: 0.413892
valid_loss: 3.442422
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.3646409805556175e-06
Epoch-23 lr: 5.3646409805556175e-06
epoch 23 training time: 13.754
---------------
2025-11-06 12:41:55.388221
current #epochs=24, #steps=759
start validation
acc: 0.792500
AUC: 0.988055
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.194551
train_loss: 0.408174
valid_loss: 3.443018
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.559944833472275e-06
Epoch-24 lr: 4.559944833472275e-06
epoch 24 training time: 13.640
---------------
2025-11-06 12:42:09.028779
current #epochs=25, #steps=792
Epoch: [25][8/33]	Per Sample Total Time 0.01441	Per Sample Data Time 0.01106	Per Sample DNN Time 0.00335	Train Loss 0.4066	
start validation
acc: 0.800000
AUC: 0.988501
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.215182
train_loss: 0.408548
valid_loss: 3.442252
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.875953108451433e-06
Epoch-25 lr: 3.875953108451433e-06
epoch 25 training time: 14.208
---------------
2025-11-06 12:42:23.236756
current #epochs=26, #steps=825
start validation
acc: 0.802500
AUC: 0.988533
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.216682
train_loss: 0.398942
valid_loss: 3.441886
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.2945601421837183e-06
Epoch-26 lr: 3.2945601421837183e-06
epoch 26 training time: 13.694
---------------
2025-11-06 12:42:36.930938
current #epochs=27, #steps=858
start validation
acc: 0.800000
AUC: 0.988399
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.210406
train_loss: 0.404272
valid_loss: 3.442357
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.8003761208561607e-06
Epoch-27 lr: 2.8003761208561607e-06
epoch 27 training time: 13.647
---------------
2025-11-06 12:42:50.577689
current #epochs=28, #steps=891
Epoch: [28][9/33]	Per Sample Total Time 0.01283	Per Sample Data Time 0.00932	Per Sample DNN Time 0.00351	Train Loss 0.3935	
start validation
acc: 0.797500
AUC: 0.988457
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.213088
train_loss: 0.394376
valid_loss: 3.442299
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.3803197027277364e-06
Epoch-28 lr: 2.3803197027277364e-06
epoch 28 training time: 13.325
---------------
2025-11-06 12:43:03.902304
current #epochs=29, #steps=924
start validation
acc: 0.792500
AUC: 0.988316
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.206552
train_loss: 0.393633
valid_loss: 3.442517
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.0232717473185757e-06
Epoch-29 lr: 2.0232717473185757e-06
epoch 29 training time: 13.818
---------------
2025-11-06 12:43:17.720089
current #epochs=30, #steps=957
start validation
acc: 0.797500
AUC: 0.988450
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.212789
train_loss: 0.385914
valid_loss: 3.442219
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.7197809852207893e-06
Epoch-30 lr: 1.7197809852207893e-06
epoch 30 training time: 13.933
---------------
2025-11-06 12:43:31.653345
current #epochs=31, #steps=990
Epoch: [31][10/33]	Per Sample Total Time 0.01252	Per Sample Data Time 0.00909	Per Sample DNN Time 0.00344	Train Loss 0.3938	
start validation
acc: 0.797500
AUC: 0.988571
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.218487
train_loss: 0.380994
valid_loss: 3.442062
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.4618138374376709e-06
Epoch-31 lr: 1.4618138374376709e-06
epoch 31 training time: 13.553
---------------
2025-11-06 12:43:45.206759
current #epochs=32, #steps=1023
start validation
acc: 0.795000
AUC: 0.988546
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.217283
train_loss: 0.388691
valid_loss: 3.441931
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.2425417618220202e-06
Epoch-32 lr: 1.2425417618220202e-06
epoch 32 training time: 13.639
---------------
2025-11-06 12:43:58.845803
current #epochs=33, #steps=1056
start validation
acc: 0.800000
AUC: 0.988584
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.219090
train_loss: 0.380148
valid_loss: 3.441746
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.0561604975487172e-06
Epoch-33 lr: 1.0561604975487172e-06
epoch 33 training time: 13.688
---------------
2025-11-06 12:44:12.534179
current #epochs=34, #steps=1089
Epoch: [34][11/33]	Per Sample Total Time 0.01262	Per Sample Data Time 0.00934	Per Sample DNN Time 0.00328	Train Loss 0.3796	
start validation
acc: 0.795000
AUC: 0.988591
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.219391
train_loss: 0.376092
valid_loss: 3.441971
validation finished
normal learning rate scheduler step
Epoch-34 lr: 8.977364229164096e-07
Epoch-34 lr: 8.977364229164096e-07
epoch 34 training time: 14.367
---------------
2025-11-06 12:44:26.901700
current #epochs=35, #steps=1122
start validation
acc: 0.800000
AUC: 0.988495
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.214882
train_loss: 0.370902
valid_loss: 3.441980
validation finished
normal learning rate scheduler step
Epoch-35 lr: 7.630759594789481e-07
Epoch-35 lr: 7.630759594789481e-07
epoch 35 training time: 13.949
---------------
2025-11-06 12:44:40.851113
current #epochs=36, #steps=1155
start validation
acc: 0.797500
AUC: 0.988527
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.216382
train_loss: 0.382412
valid_loss: 3.441952
validation finished
normal learning rate scheduler step
Epoch-36 lr: 6.486145655571059e-07
Epoch-36 lr: 6.486145655571059e-07
epoch 36 training time: 13.661
---------------
2025-11-06 12:44:54.512612
current #epochs=37, #steps=1188
Epoch: [37][12/33]	Per Sample Total Time 0.01151	Per Sample Data Time 0.00837	Per Sample DNN Time 0.00314	Train Loss 0.3873	
start validation
acc: 0.797500
AUC: 0.988520
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.216082
train_loss: 0.375075
valid_loss: 3.441903
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.5132238072354e-07
Epoch-37 lr: 5.5132238072354e-07
epoch 37 training time: 13.607
---------------
2025-11-06 12:45:08.120027
current #epochs=38, #steps=1221
start validation
acc: 0.797500
AUC: 0.988654
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.222416
train_loss: 0.375430
valid_loss: 3.441847
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.68624023615009e-07
Epoch-38 lr: 4.68624023615009e-07
epoch 38 training time: 13.247
---------------
2025-11-06 12:45:21.366629
current #epochs=39, #steps=1254
start validation
acc: 0.800000
AUC: 0.988591
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.219391
train_loss: 0.361402
valid_loss: 3.441856
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.983304200727576e-07
Epoch-39 lr: 3.983304200727576e-07
epoch 39 training time: 13.584
---------------
2025-11-06 12:45:34.950837
current #epochs=40, #steps=1287
Epoch: [40][13/33]	Per Sample Total Time 0.01089	Per Sample Data Time 0.00751	Per Sample DNN Time 0.00339	Train Loss 0.3813	
start validation
acc: 0.800000
AUC: 0.988552
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.217584
train_loss: 0.371395
valid_loss: 3.441870
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.38580857061844e-07
Epoch-40 lr: 3.38580857061844e-07
epoch 40 training time: 13.728
---------------
2025-11-06 12:45:48.678642
current #epochs=41, #steps=1320
start validation
acc: 0.800000
AUC: 0.988571
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.218487
train_loss: 0.372327
valid_loss: 3.441877
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.877937285025674e-07
Epoch-41 lr: 2.877937285025674e-07
epoch 41 training time: 13.516
---------------
2025-11-06 12:46:02.194785
current #epochs=42, #steps=1353
start validation
acc: 0.797500
AUC: 0.988514
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.215782
train_loss: 0.373085
valid_loss: 3.441870
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.4462466922718226e-07
Epoch-42 lr: 2.4462466922718226e-07
epoch 42 training time: 13.727
---------------
2025-11-06 12:46:15.921818
current #epochs=43, #steps=1386
Epoch: [43][14/33]	Per Sample Total Time 0.01069	Per Sample Data Time 0.00739	Per Sample DNN Time 0.00330	Train Loss 0.3731	
start validation
acc: 0.800000
AUC: 0.988540
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.216983
train_loss: 0.370787
valid_loss: 3.441839
validation finished
normal learning rate scheduler step
Epoch-43 lr: 2.079309688431049e-07
Epoch-43 lr: 2.079309688431049e-07
epoch 43 training time: 14.084
---------------
2025-11-06 12:46:30.006055
current #epochs=44, #steps=1419
start validation
acc: 0.797500
AUC: 0.988540
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.216983
train_loss: 0.380361
valid_loss: 3.441853
validation finished
normal learning rate scheduler step
Epoch-44 lr: 1.7674132351663916e-07
Epoch-44 lr: 1.7674132351663916e-07
epoch 44 training time: 13.808
---------------
2025-11-06 12:46:43.814472
current #epochs=45, #steps=1452
start validation
acc: 0.800000
AUC: 0.988552
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.217584
train_loss: 0.368177
valid_loss: 3.441823
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.5023012498914328e-07
Epoch-45 lr: 1.5023012498914328e-07
epoch 45 training time: 14.072
---------------
2025-11-06 12:46:57.886257
current #epochs=46, #steps=1485
Epoch: [46][15/33]	Per Sample Total Time 0.01062	Per Sample Data Time 0.00737	Per Sample DNN Time 0.00325	Train Loss 0.3761	
start validation
acc: 0.797500
AUC: 0.988552
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.217584
train_loss: 0.372616
valid_loss: 3.441823
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.276956062407718e-07
Epoch-46 lr: 1.276956062407718e-07
epoch 46 training time: 14.358
---------------
2025-11-06 12:47:12.244446
current #epochs=47, #steps=1518
start validation
acc: 0.800000
AUC: 0.988565
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.218186
train_loss: 0.375735
valid_loss: 3.441821
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.0854126530465602e-07
Epoch-47 lr: 1.0854126530465602e-07
epoch 47 training time: 13.689
---------------
2025-11-06 12:47:25.933843
current #epochs=48, #steps=1551
start validation
acc: 0.802500
AUC: 0.988559
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.217885
train_loss: 0.373002
valid_loss: 3.441819
validation finished
normal learning rate scheduler step
Epoch-48 lr: 9.226007550895761e-08
Epoch-48 lr: 9.226007550895761e-08
epoch 48 training time: 13.692
---------------
2025-11-06 12:47:39.626095
current #epochs=49, #steps=1584
Epoch: [49][16/33]	Per Sample Total Time 0.00958	Per Sample Data Time 0.00622	Per Sample DNN Time 0.00336	Train Loss 0.3810	
start validation
acc: 0.800000
AUC: 0.988552
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.217584
train_loss: 0.374209
valid_loss: 3.441823
validation finished
normal learning rate scheduler step
Epoch-49 lr: 7.842106418261397e-08
Epoch-49 lr: 7.842106418261397e-08
epoch 49 training time: 13.330
---------------
2025-11-06 12:47:52.956395
current #epochs=50, #steps=1617
start validation
acc: 0.800000
AUC: 0.988552
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.217584
train_loss: 0.382537
valid_loss: 3.441825
validation finished
normal learning rate scheduler step
Epoch-50 lr: 6.665790455522187e-08
Epoch-50 lr: 6.665790455522187e-08
epoch 50 training time: 13.529
now process fold5
I am process 4143066, running on scotia07.inf.ed.ac.uk: starting (Thu Nov  6 12:48:45 2025)
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process esc50
use dataset mean -6.627 and std 5.358 to normalize the input.
now use noise augmentation
number of classes is 50
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process esc50
use dataset mean -6.627 and std 5.358 to normalize the input.
number of classes is 50
Now train with esc50 with 1600 training samples, evaluate with 400 samples
now load a SSL pretrained models from ./SSAST-Tiny-Patch-400.pth
pretraining patch split stride: frequency=16, time=16
pretraining patch shape: frequency=16, time=16
pretraining patch array dimension: frequency=8, time=64
pretraining number of patches=512
fine-tuning patch split stride: frequncey=10, time=10
fine-tuning number of patches=600

Creating experiment directory: ./exp/test01-esc50-f10-16-t10-16-b48-lr1e-4-ft_avgtok-tiny--SSAST-Tiny-Patch-400-1x-noiseTrue/fold5
Now starting fine-tuning for 50 epochs
running on cuda
Total parameter number is : 5.900 million
Total trainable parameter number is : 5.900 million
The mlp header uses 1 x larger lr
Total mlp parameter number is : 0.010 million
Total base parameter number is : 5.890 million
now training with esc50, main metrics: acc, loss function: CrossEntropyLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f4f2d7fb920>
The learning rate scheduler starts at 6 epoch with decay rate of 0.850 every 1 epoches
current #steps=0, #epochs=1
start training...
---------------
2025-11-06 12:48:46.672046
current #epochs=1, #steps=0
start validation
acc: 0.162500
AUC: 0.793023
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 1.155349
train_loss: 3.753595
valid_loss: 3.790611
validation finished
normal learning rate scheduler step
Epoch-1 lr: 0.0001
Epoch-1 lr: 0.0001
epoch 1 training time: 15.229
---------------
2025-11-06 12:49:01.902440
current #epochs=2, #steps=33
start validation
acc: 0.257500
AUC: 0.884815
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 1.696217
train_loss: 3.234930
valid_loss: 3.684770
validation finished
normal learning rate scheduler step
Epoch-2 lr: 0.0001
Epoch-2 lr: 0.0001
epoch 2 training time: 14.432
---------------
2025-11-06 12:49:16.334665
current #epochs=3, #steps=66
start validation
acc: 0.367500
AUC: 0.924247
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.028315
train_loss: 2.710870
valid_loss: 3.608881
validation finished
normal learning rate scheduler step
Epoch-3 lr: 0.0001
Epoch-3 lr: 0.0001
epoch 3 training time: 14.238
---------------
2025-11-06 12:49:30.572727
current #epochs=4, #steps=99
Epoch: [4][1/33]	Per Sample Total Time 0.06239	Per Sample Data Time 0.05890	Per Sample DNN Time 0.00348	Train Loss 2.5684	
start validation
acc: 0.462500
AUC: 0.953393
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.374013
train_loss: 2.215379
valid_loss: 3.550262
validation finished
normal learning rate scheduler step
Epoch-4 lr: 0.0001
Epoch-4 lr: 0.0001
epoch 4 training time: 14.042
---------------
2025-11-06 12:49:44.615062
current #epochs=5, #steps=132
start validation
acc: 0.542500
AUC: 0.964477
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.552915
train_loss: 1.811319
valid_loss: 3.519894
validation finished
normal learning rate scheduler step
Epoch-5 lr: 0.0001
Epoch-5 lr: 0.0001
epoch 5 training time: 14.022
---------------
2025-11-06 12:49:58.637155
current #epochs=6, #steps=165
start validation
acc: 0.605000
AUC: 0.970427
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.668778
train_loss: 1.506891
valid_loss: 3.502171
validation finished
normal learning rate scheduler step
Epoch-6 lr: 8.5e-05
Epoch-6 lr: 8.5e-05
epoch 6 training time: 13.859
---------------
2025-11-06 12:50:12.496343
current #epochs=7, #steps=198
Epoch: [7][2/33]	Per Sample Total Time 0.04111	Per Sample Data Time 0.03780	Per Sample DNN Time 0.00331	Train Loss 1.2062	
start validation
acc: 0.650000
AUC: 0.976199
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.801421
train_loss: 1.213920
valid_loss: 3.486752
validation finished
normal learning rate scheduler step
Epoch-7 lr: 7.225000000000001e-05
Epoch-7 lr: 7.225000000000001e-05
epoch 7 training time: 13.762
---------------
2025-11-06 12:50:26.258475
current #epochs=8, #steps=231
start validation
acc: 0.680000
AUC: 0.977207
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.827296
train_loss: 1.026194
valid_loss: 3.483809
validation finished
normal learning rate scheduler step
Epoch-8 lr: 6.141250000000001e-05
Epoch-8 lr: 6.141250000000001e-05
epoch 8 training time: 13.894
---------------
2025-11-06 12:50:40.152324
current #epochs=9, #steps=264
start validation
acc: 0.682500
AUC: 0.978501
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.861993
train_loss: 0.859886
valid_loss: 3.478754
validation finished
normal learning rate scheduler step
Epoch-9 lr: 5.2200625000000005e-05
Epoch-9 lr: 5.2200625000000005e-05
epoch 9 training time: 13.718
---------------
2025-11-06 12:50:53.870847
current #epochs=10, #steps=297
Epoch: [10][3/33]	Per Sample Total Time 0.02735	Per Sample Data Time 0.02391	Per Sample DNN Time 0.00345	Train Loss 0.7814	
start validation
acc: 0.727500
AUC: 0.980459
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.917984
train_loss: 0.748026
valid_loss: 3.471084
validation finished
normal learning rate scheduler step
Epoch-10 lr: 4.437053125e-05
Epoch-10 lr: 4.437053125e-05
epoch 10 training time: 13.848
---------------
2025-11-06 12:51:07.718904
current #epochs=11, #steps=330
start validation
acc: 0.730000
AUC: 0.980026
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.905185
train_loss: 0.673844
valid_loss: 3.466118
validation finished
normal learning rate scheduler step
Epoch-11 lr: 3.77149515625e-05
Epoch-11 lr: 3.77149515625e-05
epoch 11 training time: 14.157
---------------
2025-11-06 12:51:21.876001
current #epochs=12, #steps=363
start validation
acc: 0.717500
AUC: 0.981027
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.935105
train_loss: 0.608220
valid_loss: 3.464184
validation finished
normal learning rate scheduler step
Epoch-12 lr: 3.2057708828124995e-05
Epoch-12 lr: 3.2057708828124995e-05
epoch 12 training time: 13.614
---------------
2025-11-06 12:51:35.490406
current #epochs=13, #steps=396
Epoch: [13][4/33]	Per Sample Total Time 0.02445	Per Sample Data Time 0.02112	Per Sample DNN Time 0.00333	Train Loss 0.5813	
start validation
acc: 0.752500
AUC: 0.982423
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.979169
train_loss: 0.557498
valid_loss: 3.462278
validation finished
normal learning rate scheduler step
Epoch-13 lr: 2.7249052503906245e-05
Epoch-13 lr: 2.7249052503906245e-05
epoch 13 training time: 13.773
---------------
2025-11-06 12:51:49.263330
current #epochs=14, #steps=429
start validation
acc: 0.765000
AUC: 0.983355
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.010236
train_loss: 0.508712
valid_loss: 3.459108
validation finished
normal learning rate scheduler step
Epoch-14 lr: 2.3161694628320308e-05
Epoch-14 lr: 2.3161694628320308e-05
epoch 14 training time: 14.092
---------------
2025-11-06 12:52:03.355308
current #epochs=15, #steps=462
start validation
acc: 0.760000
AUC: 0.982506
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.981878
train_loss: 0.471983
valid_loss: 3.460908
validation finished
normal learning rate scheduler step
Epoch-15 lr: 1.9687440434072263e-05
Epoch-15 lr: 1.9687440434072263e-05
epoch 15 training time: 13.945
---------------
2025-11-06 12:52:17.300267
current #epochs=16, #steps=495
Epoch: [16][5/33]	Per Sample Total Time 0.01951	Per Sample Data Time 0.01620	Per Sample DNN Time 0.00331	Train Loss 0.4666	
start validation
acc: 0.765000
AUC: 0.982430
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.979377
train_loss: 0.457974
valid_loss: 3.460200
validation finished
normal learning rate scheduler step
Epoch-16 lr: 1.673432436896142e-05
Epoch-16 lr: 1.673432436896142e-05
epoch 16 training time: 13.211
---------------
2025-11-06 12:52:30.511298
current #epochs=17, #steps=528
start validation
acc: 0.777500
AUC: 0.982736
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.989436
train_loss: 0.416760
valid_loss: 3.459307
validation finished
normal learning rate scheduler step
Epoch-17 lr: 1.4224175713617208e-05
Epoch-17 lr: 1.4224175713617208e-05
epoch 17 training time: 13.868
---------------
2025-11-06 12:52:44.378707
current #epochs=18, #steps=561
start validation
acc: 0.772500
AUC: 0.983233
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.006110
train_loss: 0.403441
valid_loss: 3.460366
validation finished
normal learning rate scheduler step
Epoch-18 lr: 1.2090549356574626e-05
Epoch-18 lr: 1.2090549356574626e-05
epoch 18 training time: 13.895
---------------
2025-11-06 12:52:58.274177
current #epochs=19, #steps=594
Epoch: [19][6/33]	Per Sample Total Time 0.01961	Per Sample Data Time 0.01641	Per Sample DNN Time 0.00320	Train Loss 0.4076	
start validation
acc: 0.767500
AUC: 0.982851
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.993247
train_loss: 0.401617
valid_loss: 3.461113
validation finished
normal learning rate scheduler step
Epoch-19 lr: 1.0276966953088432e-05
Epoch-19 lr: 1.0276966953088432e-05
epoch 19 training time: 13.678
---------------
2025-11-06 12:53:11.951874
current #epochs=20, #steps=627
start validation
acc: 0.772500
AUC: 0.982487
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.981252
train_loss: 0.374407
valid_loss: 3.459980
validation finished
normal learning rate scheduler step
Epoch-20 lr: 8.735421910125167e-06
Epoch-20 lr: 8.735421910125167e-06
epoch 20 training time: 13.932
---------------
2025-11-06 12:53:25.883806
current #epochs=21, #steps=660
start validation
acc: 0.767500
AUC: 0.982787
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 2.991127
train_loss: 0.366717
valid_loss: 3.458822
validation finished
normal learning rate scheduler step
Epoch-21 lr: 7.425108623606392e-06
Epoch-21 lr: 7.425108623606392e-06
epoch 21 training time: 13.940
---------------
2025-11-06 12:53:39.823731
current #epochs=22, #steps=693
Epoch: [22][7/33]	Per Sample Total Time 0.01774	Per Sample Data Time 0.01448	Per Sample DNN Time 0.00327	Train Loss 0.3703	
start validation
acc: 0.772500
AUC: 0.983068
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.000506
train_loss: 0.360643
valid_loss: 3.458481
validation finished
normal learning rate scheduler step
Epoch-22 lr: 6.3113423300654325e-06
Epoch-22 lr: 6.3113423300654325e-06
epoch 22 training time: 13.751
---------------
2025-11-06 12:53:53.575059
current #epochs=23, #steps=726
start validation
acc: 0.767500
AUC: 0.983151
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.003302
train_loss: 0.358349
valid_loss: 3.458959
validation finished
normal learning rate scheduler step
Epoch-23 lr: 5.3646409805556175e-06
Epoch-23 lr: 5.3646409805556175e-06
epoch 23 training time: 14.239
---------------
2025-11-06 12:54:07.813774
current #epochs=24, #steps=759
start validation
acc: 0.767500
AUC: 0.983374
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.010890
train_loss: 0.368583
valid_loss: 3.457837
validation finished
normal learning rate scheduler step
Epoch-24 lr: 4.559944833472275e-06
Epoch-24 lr: 4.559944833472275e-06
epoch 24 training time: 14.259
---------------
2025-11-06 12:54:22.072655
current #epochs=25, #steps=792
Epoch: [25][8/33]	Per Sample Total Time 0.01689	Per Sample Data Time 0.01366	Per Sample DNN Time 0.00323	Train Loss 0.3524	
start validation
acc: 0.770000
AUC: 0.983520
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.015924
train_loss: 0.343950
valid_loss: 3.457917
validation finished
normal learning rate scheduler step
Epoch-25 lr: 3.875953108451433e-06
Epoch-25 lr: 3.875953108451433e-06
epoch 25 training time: 14.397
---------------
2025-11-06 12:54:36.469808
current #epochs=26, #steps=825
start validation
acc: 0.777500
AUC: 0.983903
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.029238
train_loss: 0.337379
valid_loss: 3.457640
validation finished
normal learning rate scheduler step
Epoch-26 lr: 3.2945601421837183e-06
Epoch-26 lr: 3.2945601421837183e-06
epoch 26 training time: 13.912
---------------
2025-11-06 12:54:50.381781
current #epochs=27, #steps=858
start validation
acc: 0.775000
AUC: 0.983750
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.023880
train_loss: 0.330051
valid_loss: 3.458419
validation finished
normal learning rate scheduler step
Epoch-27 lr: 2.8003761208561607e-06
Epoch-27 lr: 2.8003761208561607e-06
epoch 27 training time: 13.732
---------------
2025-11-06 12:55:04.113424
current #epochs=28, #steps=891
Epoch: [28][9/33]	Per Sample Total Time 0.01257	Per Sample Data Time 0.00922	Per Sample DNN Time 0.00336	Train Loss 0.3086	
start validation
acc: 0.775000
AUC: 0.983546
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.016803
train_loss: 0.324546
valid_loss: 3.458314
validation finished
normal learning rate scheduler step
Epoch-28 lr: 2.3803197027277364e-06
Epoch-28 lr: 2.3803197027277364e-06
epoch 28 training time: 13.532
---------------
2025-11-06 12:55:17.645451
current #epochs=29, #steps=924
start validation
acc: 0.770000
AUC: 0.983699
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.022104
train_loss: 0.329749
valid_loss: 3.457623
validation finished
normal learning rate scheduler step
Epoch-29 lr: 2.0232717473185757e-06
Epoch-29 lr: 2.0232717473185757e-06
epoch 29 training time: 13.458
---------------
2025-11-06 12:55:31.103975
current #epochs=30, #steps=957
start validation
acc: 0.770000
AUC: 0.983686
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.021661
train_loss: 0.327377
valid_loss: 3.457400
validation finished
normal learning rate scheduler step
Epoch-30 lr: 1.7197809852207893e-06
Epoch-30 lr: 1.7197809852207893e-06
epoch 30 training time: 13.976
---------------
2025-11-06 12:55:45.079730
current #epochs=31, #steps=990
Epoch: [31][10/33]	Per Sample Total Time 0.01242	Per Sample Data Time 0.00909	Per Sample DNN Time 0.00332	Train Loss 0.3255	
start validation
acc: 0.775000
AUC: 0.983693
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.021882
train_loss: 0.333527
valid_loss: 3.457574
validation finished
normal learning rate scheduler step
Epoch-31 lr: 1.4618138374376709e-06
Epoch-31 lr: 1.4618138374376709e-06
epoch 31 training time: 13.711
---------------
2025-11-06 12:55:58.790322
current #epochs=32, #steps=1023
start validation
acc: 0.775000
AUC: 0.983820
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.026331
train_loss: 0.333409
valid_loss: 3.457516
validation finished
normal learning rate scheduler step
Epoch-32 lr: 1.2425417618220202e-06
Epoch-32 lr: 1.2425417618220202e-06
epoch 32 training time: 13.698
---------------
2025-11-06 12:56:12.488245
current #epochs=33, #steps=1056
start validation
acc: 0.775000
AUC: 0.983827
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.026554
train_loss: 0.329547
valid_loss: 3.457630
validation finished
normal learning rate scheduler step
Epoch-33 lr: 1.0561604975487172e-06
Epoch-33 lr: 1.0561604975487172e-06
epoch 33 training time: 14.092
---------------
2025-11-06 12:56:26.580496
current #epochs=34, #steps=1089
Epoch: [34][11/33]	Per Sample Total Time 0.01292	Per Sample Data Time 0.00962	Per Sample DNN Time 0.00330	Train Loss 0.3390	
start validation
acc: 0.772500
AUC: 0.983712
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.022548
train_loss: 0.320838
valid_loss: 3.457581
validation finished
normal learning rate scheduler step
Epoch-34 lr: 8.977364229164096e-07
Epoch-34 lr: 8.977364229164096e-07
epoch 34 training time: 13.805
---------------
2025-11-06 12:56:40.385997
current #epochs=35, #steps=1122
start validation
acc: 0.772500
AUC: 0.983763
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.024325
train_loss: 0.320071
valid_loss: 3.457469
validation finished
normal learning rate scheduler step
Epoch-35 lr: 7.630759594789481e-07
Epoch-35 lr: 7.630759594789481e-07
epoch 35 training time: 14.271
---------------
2025-11-06 12:56:54.657479
current #epochs=36, #steps=1155
start validation
acc: 0.772500
AUC: 0.983795
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.025439
train_loss: 0.331285
valid_loss: 3.457521
validation finished
normal learning rate scheduler step
Epoch-36 lr: 6.486145655571059e-07
Epoch-36 lr: 6.486145655571059e-07
epoch 36 training time: 13.839
---------------
2025-11-06 12:57:08.495979
current #epochs=37, #steps=1188
Epoch: [37][12/33]	Per Sample Total Time 0.01262	Per Sample Data Time 0.00948	Per Sample DNN Time 0.00314	Train Loss 0.3250	
start validation
acc: 0.772500
AUC: 0.983763
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.024325
train_loss: 0.327248
valid_loss: 3.457681
validation finished
normal learning rate scheduler step
Epoch-37 lr: 5.5132238072354e-07
Epoch-37 lr: 5.5132238072354e-07
epoch 37 training time: 14.427
---------------
2025-11-06 12:57:22.923533
current #epochs=38, #steps=1221
start validation
acc: 0.775000
AUC: 0.983795
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.025439
train_loss: 0.323443
valid_loss: 3.457566
validation finished
normal learning rate scheduler step
Epoch-38 lr: 4.68624023615009e-07
Epoch-38 lr: 4.68624023615009e-07
epoch 38 training time: 13.316
---------------
2025-11-06 12:57:36.239280
current #epochs=39, #steps=1254
start validation
acc: 0.775000
AUC: 0.983776
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.024770
train_loss: 0.310813
valid_loss: 3.457526
validation finished
normal learning rate scheduler step
Epoch-39 lr: 3.983304200727576e-07
Epoch-39 lr: 3.983304200727576e-07
epoch 39 training time: 13.254
---------------
2025-11-06 12:57:49.493322
current #epochs=40, #steps=1287
Epoch: [40][13/33]	Per Sample Total Time 0.01120	Per Sample Data Time 0.00797	Per Sample DNN Time 0.00323	Train Loss 0.3292	
start validation
acc: 0.775000
AUC: 0.983776
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.024770
train_loss: 0.324393
valid_loss: 3.457465
validation finished
normal learning rate scheduler step
Epoch-40 lr: 3.38580857061844e-07
Epoch-40 lr: 3.38580857061844e-07
epoch 40 training time: 13.693
---------------
2025-11-06 12:58:03.186191
current #epochs=41, #steps=1320
start validation
acc: 0.775000
AUC: 0.983791
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.025327
train_loss: 0.323606
valid_loss: 3.457403
validation finished
normal learning rate scheduler step
Epoch-41 lr: 2.877937285025674e-07
Epoch-41 lr: 2.877937285025674e-07
epoch 41 training time: 13.498
---------------
2025-11-06 12:58:16.683862
current #epochs=42, #steps=1353
start validation
acc: 0.775000
AUC: 0.983737
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.023436
train_loss: 0.318358
valid_loss: 3.457464
validation finished
normal learning rate scheduler step
Epoch-42 lr: 2.4462466922718226e-07
Epoch-42 lr: 2.4462466922718226e-07
epoch 42 training time: 13.592
---------------
2025-11-06 12:58:30.276018
current #epochs=43, #steps=1386
Epoch: [43][14/33]	Per Sample Total Time 0.01004	Per Sample Data Time 0.00674	Per Sample DNN Time 0.00331	Train Loss 0.3158	
start validation
acc: 0.775000
AUC: 0.983712
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.022548
train_loss: 0.323182
valid_loss: 3.457572
validation finished
normal learning rate scheduler step
Epoch-43 lr: 2.079309688431049e-07
Epoch-43 lr: 2.079309688431049e-07
epoch 43 training time: 14.062
---------------
2025-11-06 12:58:44.337934
current #epochs=44, #steps=1419
start validation
acc: 0.775000
AUC: 0.983728
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.023103
train_loss: 0.321011
valid_loss: 3.457584
validation finished
normal learning rate scheduler step
Epoch-44 lr: 1.7674132351663916e-07
Epoch-44 lr: 1.7674132351663916e-07
epoch 44 training time: 14.012
---------------
2025-11-06 12:58:58.350400
current #epochs=45, #steps=1452
start validation
acc: 0.775000
AUC: 0.983712
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.022548
train_loss: 0.318310
valid_loss: 3.457610
validation finished
normal learning rate scheduler step
Epoch-45 lr: 1.5023012498914328e-07
Epoch-45 lr: 1.5023012498914328e-07
epoch 45 training time: 14.045
---------------
2025-11-06 12:59:12.395123
current #epochs=46, #steps=1485
Epoch: [46][15/33]	Per Sample Total Time 0.01023	Per Sample Data Time 0.00690	Per Sample DNN Time 0.00332	Train Loss 0.3206	
start validation
acc: 0.775000
AUC: 0.983705
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.022326
train_loss: 0.314634
valid_loss: 3.457603
validation finished
normal learning rate scheduler step
Epoch-46 lr: 1.276956062407718e-07
Epoch-46 lr: 1.276956062407718e-07
epoch 46 training time: 14.044
---------------
2025-11-06 12:59:26.439579
current #epochs=47, #steps=1518
start validation
acc: 0.775000
AUC: 0.983693
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.021882
train_loss: 0.326986
valid_loss: 3.457610
validation finished
normal learning rate scheduler step
Epoch-47 lr: 1.0854126530465602e-07
Epoch-47 lr: 1.0854126530465602e-07
epoch 47 training time: 14.291
---------------
2025-11-06 12:59:40.730882
current #epochs=48, #steps=1551
start validation
acc: 0.775000
AUC: 0.983693
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.021882
train_loss: 0.324774
valid_loss: 3.457586
validation finished
normal learning rate scheduler step
Epoch-48 lr: 9.226007550895761e-08
Epoch-48 lr: 9.226007550895761e-08
epoch 48 training time: 14.258
---------------
2025-11-06 12:59:54.989049
current #epochs=49, #steps=1584
Epoch: [49][16/33]	Per Sample Total Time 0.01035	Per Sample Data Time 0.00698	Per Sample DNN Time 0.00338	Train Loss 0.3198	
start validation
acc: 0.775000
AUC: 0.983693
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.021882
train_loss: 0.321555
valid_loss: 3.457561
validation finished
normal learning rate scheduler step
Epoch-49 lr: 7.842106418261397e-08
Epoch-49 lr: 7.842106418261397e-08
epoch 49 training time: 14.297
---------------
2025-11-06 13:00:09.285900
current #epochs=50, #steps=1617
start validation
acc: 0.775000
AUC: 0.983693
Avg Precision: 0.020000
Avg Recall: 1.000000
d_prime: 3.021882
train_loss: 0.313944
valid_loss: 3.457548
validation finished
normal learning rate scheduler step
Epoch-50 lr: 6.665790455522187e-08
Epoch-50 lr: 6.665790455522187e-08
epoch 50 training time: 13.728
--------------Result Summary--------------
Fold 1 accuracy: 0.8350
Fold 2 accuracy: 0.8050
Fold 3 accuracy: 0.8225
Fold 4 accuracy: 0.8000
Fold 5 accuracy: 0.7750
The averaged accuracy of 5 folds is 0.808
